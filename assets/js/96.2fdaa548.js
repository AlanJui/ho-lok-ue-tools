(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{382:function(a,s,t){"use strict";t.r(s);var e=t(10),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"ubuntu-建置-django-整合測試伺服器安裝指引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-建置-django-整合測試伺服器安裝指引"}},[a._v("#")]),a._v(" Ubuntu 建置 Django 整合測試伺服器安裝指引")]),a._v(" "),s("h2",{attrs:{id:"摘要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#摘要"}},[a._v("#")]),a._v(" 摘要")]),a._v(" "),s("p",[a._v("本文件用於說明：在 Django App 的開發流程中，如何使用 VM 建置「整合及測試伺服器」。")]),a._v(" "),s("ul",[s("li",[a._v("VM 建置工具： VitualBox；")]),a._v(" "),s("li",[a._v("VM 作業系統：Ubuntu Desktop 20.04 。")])]),a._v(" "),s("p",[a._v("【主要章節】：")]),a._v(" "),s("ul",[s("li",[a._v("建置 Ubuntu 虛擬電腦")]),a._v(" "),s("li",[a._v("建置 Django App 作業平台")]),a._v(" "),s("li",[a._v("安裝 Django App 原始碼")]),a._v(" "),s("li",[a._v("建置 Django App 用 HTTP 服務")]),a._v(" "),s("li",[a._v("建置 Django App 用 DB 服務")]),a._v(" "),s("li",[a._v("建置 Django App 用 uWSGI 服務")]),a._v(" "),s("li",[a._v("建置 Django App Server")])]),a._v(" "),s("h2",{attrs:{id:"建置-ubuntu-虛擬電腦"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#建置-ubuntu-虛擬電腦"}},[a._v("#")]),a._v(" 建置 Ubuntu 虛擬電腦")]),a._v(" "),s("p",[a._v("【安裝需求】：")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("主機(Host)：MacBookPro 2012")]),a._v(" "),s("ul",[s("li",[a._v("CPU: 2.9 GHz 2 核心 Intel Core i7")]),a._v(" "),s("li",[a._v("RAM: 16 GB 1600 MHz DDR3")]),a._v(" "),s("li",[a._v("顯卡：Intel HD Graphics 4000 1536 MB")]),a._v(" "),s("li",[a._v("硬碟：1TB SSD")]),a._v(" "),s("li",[a._v("OS: macOS Catalina")])])]),a._v(" "),s("li",[s("p",[a._v("VirtualBox: V6.1.18 (Qt5.6.3)")])])]),a._v(" "),s("p",[a._v("【建置 VM 作業】：")]),a._v(" "),s("p",[s("RouterLink",{attrs:{to:"/_my_dev_env/Debian/Ubuntu-Install_SIT_Server-Initial.html"}},[a._v("《Ubuntu 20.04 VM 建置作業》")])],1),a._v(" "),s("h2",{attrs:{id:"建置-django-app-作業平台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#建置-django-app-作業平台"}},[a._v("#")]),a._v(" 建置 Django App 作業平台")]),a._v(" "),s("p",[s("RouterLink",{attrs:{to:"/_my_dev_env/Debian/Ubuntu-Install_SIT_Server-Build_DjangoApp_Platform.html"}},[a._v("《在 Ubuntu 建置 Django App 作業平台指引》")])],1),a._v(" "),s("h2",{attrs:{id:"建置-django-app-管理員帳號"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#建置-django-app-管理員帳號"}},[a._v("#")]),a._v(" 建置 Django App 管理員帳號")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("建置 Django App 帳號：web-admin。")])]),a._v(" "),s("li",[s("p",[a._v("Logout 後，再以 Django App 管理員帳號登入。")])]),a._v(" "),s("li",[s("p",[a._v("設定「登入帳號」屬 www-data 群組。")])])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("sudo usermod -aG www-data $USER\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"4"}},[s("li",[a._v("確認 www-data 群組已建立。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("cat /etc/group | grep www-data\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("📺")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("alanjui@VB02-Ubuntu-2004:/var/www/mysite.ccc.tw.local$ cat /etc/group | grep www-data\nwww-data:x:33:alanjui\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("ol",{attrs:{start:"5"}},[s("li",[a._v("檢查「使用者帳號」及其所歸屬「群組」。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("id\ngroups\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("📺")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("alanjui@VB02-Ubuntu-2004:/var/www/mysite.ccc.tw.local$ id\n使用者id=1000(alanjui) id群組=1000(alanjui) 組=1000(alanjui),4(adm),24(cdrom),27(sudo),30(dip),33(www-data),46(plugdev),120(lpadmin),131(lxd),132(sambashare)\n\nalanjui@VB02-Ubuntu-2004:/var/www/mysite.ccc.tw.local$ groups\nalanjui adm cdrom sudo dip www-data plugdev lpadmin lxd sambashare\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h2",{attrs:{id:"安裝-django-app-原始碼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安裝-django-app-原始碼"}},[a._v("#")]),a._v(" 安裝 Django App 原始碼")]),a._v(" "),s("ol",[s("li",[a._v("建置 Django App 目錄。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("sudo su\ncd /var/www\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("將 Django App 原始碼放入 Django App 目錄。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('git clone [User]@[URL]:"~/Path/to/ProjectRepo" [domain-name]\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("📺")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('$ git clone alanjui@192.168.66.21:"~/workspace/django/test-100" app.ccc.tw.local\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("設定「目錄」的擁有使用者及使用權限。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("chown -R www-data:www-data /var/www/[domain-name]\nchmod -R 775 /var/www/[domain-name]\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("📺")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("$ chown -R www-data:www-data /var/www/app.ccc.tw.local\n$ chmod -R 775 /var/www/app.ccc.tw.local\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h2",{attrs:{id:"建置-http-服務"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#建置-http-服務"}},[a._v("#")]),a._v(" 建置 HTTP 服務")]),a._v(" "),s("p",[a._v("使用 nginx 服務，針對：網頁、圖片、CSS、JavaScript⋯⋯ 等檔案（Static Files），可利用\nHTTP 通信協定，提供檔案下載功能。")]),a._v(" "),s("p",[s("RouterLink",{attrs:{to:"/_my_dev_env/Debian/Ubuntu-Install_Nginx_as_HTTP_Server.html"}},[a._v("《以 Nginx 建置 HTTP Server 指引》")])],1),a._v(" "),s("ol",[s("li",[a._v("修改 settings.py 檔案內的設定：")])]),a._v(" "),s("ul",[s("li",[a._v("ALLOWED_HOSTS")]),a._v(" "),s("li",[a._v("STATIC_ROOT")]),a._v(" "),s("li",[a._v("MEDIA_ROOT")])]),a._v(" "),s("p",[a._v("🔖")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("....\nALLOWED_HOSTS = [\n    'mysite.ccc.tw.local',\n    'localhost',\n    '127.0.0.1',\n]\n....\nSTATIC_ROOT = BASE_DIR / 'static_collected'\n....\nMEDIA_ROOT = BASE_DIR / 'media'\nMEDIA_URL = '/media/'\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("設定 urls.py 檔。")])]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.djangoproject.com/en/3.1/howto/static-files/#serving-files-uploaded-by-a-user-during-development",target:"_blank",rel:"noopener noreferrer"}},[a._v("Serving files uploaded by a user during development"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://docs.djangoproject.com/en/3.1/howto/static-files/#serving-files-uploaded-by-a-user-during-development",target:"_blank",rel:"noopener noreferrer"}},[a._v("Managing static files (e.g. images, JavaScript, CSS)"),s("OutboundLink")],1)])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("from django.conf import settings\nfrom django.conf.urls.static import static\n\nurlpatterns = [\n    # ... the rest of your URLconf goes here ...\n] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("p",[a._v("🔖 Django > v1.7 and < v3.0")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("urlpatterns = patterns('',\n    # ... the rest of your URLconf goes here ...\n) + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("ul",[s("li",[a._v("不在 DEBUG Mode 不啟用的寫法：")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("if settings.DEBUG:\n    urlpatterns += patterns('django.views.static',\n        (r'media/(?P<path>.*)', 'serve', {'document_root': settings.MEDIA_ROOT}),\n    )\n\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h2",{attrs:{id:"建置-db-服務"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#建置-db-服務"}},[a._v("#")]),a._v(" 建置 DB 服務")]),a._v(" "),s("p",[a._v("建置「資料庫系統」，用以支援 Django App 在資料存取所需之功能。")]),a._v(" "),s("p",[s("RouterLink",{attrs:{to:"/_my_dev_env/Debian/Ubuntu-Install_Postgres_DB_Server.html"}},[a._v("《Postgres DB Server 安裝指引》")])],1),a._v(" "),s("h3",{attrs:{id:"安裝-postgres-支援套件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安裝-postgres-支援套件"}},[a._v("#")]),a._v(" 安裝 Postgres 支援套件")]),a._v(" "),s("ol",[s("li",[a._v("啟用「虛擬環境」。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("sudo su\ncd /var/www/mysite.ccc.tw.local\nsource .venv/bin/activate\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("安裝支援 psycopg2 安裝用套件")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("apt install libpq-dev\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("安裝 psycopg2 套件")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pip install psycopg2\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"變更-settings-py-設定檔"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#變更-settings-py-設定檔"}},[a._v("#")]),a._v(" 變更 settings.py 設定檔")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("vim web_config/settings.py\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("🔖 settings.py")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v(". . .\nDATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql_psycopg2',\n        'NAME': ‘<db_name>’,\n        'USER': '<db_username>',\n        'PASSWORD': '<password>',\n        'HOST': '<db_hostname_or_ip>',\n        'PORT': '<db_port>',\n    }\n}\n. . .\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("h3",{attrs:{id:"建立資料庫用-db-及-tables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#建立資料庫用-db-及-tables"}},[a._v("#")]),a._v(" 建立資料庫用 DB 及 Tables")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.enterprisedb.com/postgres-tutorials/how-use-postgresql-django",target:"_blank",rel:"noopener noreferrer"}},[a._v("How to use PostgreSQL with Django"),s("OutboundLink")],1)]),a._v(" "),s("ol",[s("li",[a._v("執行 django makemigrations 指令。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("python manage.py makemigrations\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("執行 django migrate 指令，建置資料庫系統用 DB Schema。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("python manage.py migrate\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("建立「後台使用者帳號及密碼」。")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("python manage.py createsuperuser\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"建置-uwsgi-服務"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#建置-uwsgi-服務"}},[a._v("#")]),a._v(" 建置 uWSGI 服務")]),a._v(" "),s("h3",{attrs:{id:"將已運作中之-uwsgi-服務暫停"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#將已運作中之-uwsgi-服務暫停"}},[a._v("#")]),a._v(" 將已運作中之 uwsgi 服務暫停")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("sudo su\nsystemctl status uwsgi\nsystemctl stop uwsgi\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"設定-uwsgi-執行環境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#設定-uwsgi-執行環境"}},[a._v("#")]),a._v(" 設定 uwsgi 執行環境")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("cd /var/www/\nln -nfs /var/www/app.ccc.tw.local/config/app.ccc.tw.local.ini /etc/uwsgi/apps-enabled\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"驗證-uwsgi-服務設定檔能正常運行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#驗證-uwsgi-服務設定檔能正常運行"}},[a._v("#")]),a._v(" 驗證 uwsgi 服務設定檔能正常運行")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("/usr/local/bin/uwsgi --ini /etc/uwsgi/apps-enabled/app.ccc.tw.local.ini\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"啟動-uwsgi-服務"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#啟動-uwsgi-服務"}},[a._v("#")]),a._v(" 啟動 uwsgi 服務")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("systemctl start uwsgi\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"啟動-django-app-server-作業"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#啟動-django-app-server-作業"}},[a._v("#")]),a._v(" 啟動 Django App Server 作業")]),a._v(" "),s("ol",[s("li",[a._v("進入目錄")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("sudo su\ncd /var/www/app.ccc.tw.local\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("啟動「虛擬環境」")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("source .venv/bin/activate\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("安裝 Python 套件")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pip install -r requirements.txt\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"4"}},[s("li",[a._v("設定「作業情境」的「環境變數」：")])]),a._v(" "),s("p",[a._v("設定 Django App 執行時（Run Time）應引用之「作業情境」環境變數。")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('$ export django_app_mode_for_app="prod"\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"5"}},[s("li",[a._v("搜集所有 Static 檔案")])]),a._v(" "),s("p",[a._v("安裝 HTTP Server 需使用之 static 檔案")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("python manage.py collectstatic\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"6"}},[s("li",[a._v("建置 DB Schemas")])]),a._v(" "),s("ul",[s("li",[a._v('方法一：已事先設定 djang_app_mode_for _app="prod" 環境變數用法')])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("python manage.py makemigrations\npython manage.py migrate\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("ul",[s("li",[a._v("方法二：未事先設定環境變數用圔")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("$ DJANGO_SETTINGS_MODULE=web_site.settings.prod python manage.py makemigrations\n$ DJANGO_SETTINGS_MODULE=web_site.settings.prod python manage.py migrate\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("【註】： 建置開發環境使用的 SQLite 資料庫")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("$ DJANGO_SETTINGS_MODULE=web_site.settings.dev python manage.py migrate\n$ DJANGO_SETTINGS_MODULE=web_site.settings.dev python manage.py createsuperuser\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("ol",{attrs:{start:"7"}},[s("li",[a._v("建立後台管理員帳號與密碼")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("$ DJANGO_SETTINGS_MODULE=web_site.settings.prod python manage.py createsuperuser\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"問題診斷與狀況排解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#問題診斷與狀況排解"}},[a._v("#")]),a._v(" 問題診斷與狀況排解")]),a._v(" "),s("p",[a._v("N/A")]),a._v(" "),s("h2",{attrs:{id:"參考文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#參考文件"}},[a._v("#")]),a._v(" 參考文件")]),a._v(" "),s("h3",{attrs:{id:"django-settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#django-settings"}},[a._v("#")]),a._v(" Django Settings")]),a._v(" "),s("p",[a._v("https://docs.djangoproject.com/en/2.1/topics/settings/")]),a._v(" "),s("p",[a._v("https://medium.com/@panzelva/deploying-django-website-to-vps-with-uwsgi-and-nginx-on-ubuntu-18-04-db9b387ad19d")]),a._v(" "),s("p",[a._v("How To Install Python 3 and Set Up a Programming Environment on Ubuntu 18.04 [Quickstart]\nhttps://www.digitalocean.com/community/tutorials/how-to-install-python-3-and-set-up-a-programming-environment-on-ubuntu-18-04-quickstart")]),a._v(" "),s("h3",{attrs:{id:"多重環境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多重環境"}},[a._v("#")]),a._v(" 多重環境")]),a._v(" "),s("p",[a._v("https://stackoverflow.com/questions/10664244/django-how-to-manage-development-and-production-settings")])])}),[],!1,null,null,null);s.default=n.exports}}]);