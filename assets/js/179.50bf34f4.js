(window.webpackJsonp=window.webpackJsonp||[]).push([[179],{467:function(s,a,e){"use strict";e.r(a);var n=e(10),t=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"macos-建置-django-開發作業環境指引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#macos-建置-django-開發作業環境指引"}},[s._v("#")]),s._v(" macOS 建置 Django 開發作業環境指引")]),s._v(" "),a("h2",{attrs:{id:"摘要"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#摘要"}},[s._v("#")]),s._v(" 摘要")]),s._v(" "),a("p",[s._v("在 macOS 作業系統，建置 Django App 之「開發作業平台」。")]),s._v(" "),a("ul",[a("li",[s._v("安裝開發作業基礎工具")]),s._v(" "),a("li",[s._v("安裝 Node.js 作業環境")]),s._v(" "),a("li",[s._v("安裝 Python 作業環境")]),s._v(" "),a("li",[s._v("安裝編輯器")]),s._v(" "),a("li",[s._v("安裝 nginx 服務")]),s._v(" "),a("li",[s._v("安裝 Django App 原始碼")]),s._v(" "),a("li",[s._v("安裝 uWSGI 服務")])]),s._v(" "),a("h2",{attrs:{id:"安裝開發作業基礎工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝開發作業基礎工具"}},[s._v("#")]),s._v(" 安裝開發作業基礎工具")]),s._v(" "),a("ol",[a("li",[s._v("安裝 git 版本管理套件。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("brew install git\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("安裝檔案下載工具。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("brew install curl\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"安裝-node-js-作業環境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-node-js-作業環境"}},[s._v("#")]),s._v(" 安裝 Node.js 作業環境")]),s._v(" "),a("h3",{attrs:{id:"安裝-node-與-npm-套件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-node-與-npm-套件"}},[s._v("#")]),s._v(" 安裝 node 與 npm 套件")]),s._v(" "),a("ol",[a("li",[s._v("安裝 n 套件管理器")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd\ncurl -L https://git.io/n-install | bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("或")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("brew install n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("在 Bash Shell 設定檔，設定 PATH 環境變數。")])]),s._v(" "),a("p",[s._v("🔖 ~/.bashrc")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#export N_PREFIX="$HOME/n"; [[ :$PATH: == *":$N_PREFIX/bin:"* ]] || PATH+=":$N_PREFIX/bin"  # Added by n-install (see http://git.io/n-install-repo).\nexport N_PREFIX="$HOME/n";\nexport PATH="$N_PREFIX/bin:$PATH"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("重啟 Bash Shell 。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("source ~/.bashrc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("透過 n 套件管理器，安裝 node 與 npm 套件。")])]),s._v(" "),a("ul",[a("li",[s._v("最新版")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("n latest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("最近 LTS 版")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("n lts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"安裝套件管理器-yarn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝套件管理器-yarn"}},[s._v("#")]),s._v(" 安裝套件管理器：yarn")]),s._v(" "),a("p",[s._v("npm 本身即是 Node 之「套件管理器」。何以要再安裝 yarn ，主要原因是有些套件的安裝\n偏好使用 yarn 所致。")]),s._v(" "),a("ol",[a("li",[s._v("安裝")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo npm i -g yarn\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("驗證")])]),s._v(" "),a("p",[s._v("yarn 安裝位置： /usr/local/bin/yarn")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("which yarn\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"安裝-python-作業環境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-python-作業環境"}},[s._v("#")]),s._v(" 安裝 Python 作業環境")]),s._v(" "),a("h3",{attrs:{id:"安裝版本管理器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝版本管理器"}},[s._v("#")]),s._v(" 安裝版本管理器")]),s._v(" "),a("p",[s._v("安裝 Python 版本管理器：pyenv。")]),s._v(" "),a("ol",[a("li",[s._v("執行安裝。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("git clone https://github.com/pyenv/pyenv.git ~/.pyenv\ngit clone https://github.com/pyenv/pyenv-virtualenv.git ~/.pyenv/plugins/pyenv-virtualenv\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("設定 Shell 環境，執行 pyenv 所需「環境變數」。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim ~/.bashrc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("🔖 ~/.bashrc:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('export PYENV_ROOT="$HOME/.pyenv"\nexport PATH="$PYENV_ROOT/bin:$PATH"\nif command -v pyenv 1>/dev/null 2>&1; then\n  eval "$(pyenv init -)"\n  eval "$(pyenv virtualenv-init -)"\nfi\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("重啟 Shell ，啟用 pyenv 。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("source ~/.bashrc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("查驗 pyenv 安裝路徑：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("which pyenv\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("驗證 pyenv 已能運作。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pyenv versions\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("📺")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("alanjui@VB02-Ubuntu-2004:~$ which pyenv\n/home/alanjui/.pyenv/bin/pyenv\n\nalanjui@VB02-Ubuntu-2004:~$ pyenv versions\n* system (set by /home/alanjui/.pyenv/version)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"安裝特定版本直譯器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝特定版本直譯器"}},[s._v("#")]),s._v(" 安裝特定版本直譯器")]),s._v(" "),a("p",[s._v("透過 pyenv 指令，安裝指定版本之 Python 直譯器。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pyenv install [Version_No]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"設定預設-python"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#設定預設-python"}},[s._v("#")]),s._v(" 設定預設 Python")]),s._v(" "),a("p",[s._v("將某版本 Python 直譯器，設定成作業系統的「預設 Python 直譯器」。")]),s._v(" "),a("ol",[a("li",[s._v("使用 pyenv global 指令，指派作業系統層級之「預設 Python」。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pyenv global [Version_No]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("📺")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pyenv global 3.9.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("使用 pyenv versions 指令，查詢「預設 Python」之版本編號。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pyenv versions\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("執行下列二指令，用以驗證「Python 直譯器所月嵬之版本編號」與「預設 Python」\n所見「版本編號」一致。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pyenv versions\npython\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("執行下列指令，用以驗證 Python [Version_No] 之一致性")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pyenv --version\n~/.pyenv/shims/python --version\n~/.pyenv/versions/[Version_No]/bin/python --version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"安裝-vim-編輯器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-vim-編輯器"}},[s._v("#")]),s._v(" 安裝 Vim 編輯器")]),s._v(" "),a("p",[s._v("安裝 Vim 編輯器。")]),s._v(" "),a("h3",{attrs:{id:"自原始碼安裝軟體"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自原始碼安裝軟體"}},[s._v("#")]),s._v(" 自原始碼安裝軟體")]),s._v(" "),a("ol",[a("li",[s._v("下載原始碼。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd ~/build\ngit clone https://github.com/vim/vim.git\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("編輯原始碼與安裝執行檔。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd vim\n./configure\nsudo apt install ncurses-dev\nmake\nsudo make install\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"設定作業環境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#設定作業環境"}},[s._v("#")]),s._v(" 設定作業環境")]),s._v(" "),a("ol",[a("li",[s._v("安裝 vim 作業設定檔")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("git clone https://github.com/AlanJui/vim8.git ~/.vim\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("安裝 Vim Plugins。")])]),s._v(" "),a("p",[s._v("啟動 vim ，以便 vim 自動安裝 vim plugins 。")]),s._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[s._v("安裝 vim plugins 相依套件。")])]),s._v(" "),a("ul",[a("li",[s._v("安裝作業系統層級套件")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo apt install vifm\nsudo apt install fzf\nsudo apt install ripgrep\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("安裝 npm 套件")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm i -g bash-language-server\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"安裝-nginx-服務"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-nginx-服務"}},[s._v("#")]),s._v(" 安裝 nginx 服務")]),s._v(" "),a("p",[s._v("安裝 nginx 作為 HTTP Server。")]),s._v(" "),a("h3",{attrs:{id:"安裝-nginx-套件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-nginx-套件"}},[s._v("#")]),s._v(" 安裝 nginx 套件")]),s._v(" "),a("ol",[a("li",[s._v("安裝 nginx 套件。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("brew install nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("啟用 nginx 服務。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("brew servies start nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("驗證 nginx 服務已啟動。")])]),s._v(" "),a("ul",[a("li",[s._v("驗證服務已啟用，且能隨作業系統開機自動啟動")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("brew servies list\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("驗證 nginx 的 HTTP Server 已能正常運作")])]),s._v(" "),a("p",[s._v("使用 Web 瀏覽器，瀏覽如下網址，若能正常閱讀「網頁」內容，則表 HTTP Server 已能\n正常運作。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("http://[IP_Address]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"/assets/img/nginx/nginx_browse_test.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"建置-nginx-虛擬網站"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#建置-nginx-虛擬網站"}},[s._v("#")]),s._v(" 建置 nginx 虛擬網站")]),s._v(" "),a("ol",[a("li",[s._v("建置「網站目錄」。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('sudo su\nmkdir /var/www/app.ccc.tw.local && cd $_\necho "app.ccc.tw.local Web Site" > index.html\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("套用 defaut 虛擬網站設定檔，建置 Django App 虛擬網站。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /var/www/sites-available\ncp default app.ccc.tw.local\nvim  app.ccc.tw.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("🔖 app.ccc.tw.local:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("server {\n    listen 80;\n\n    server_name app.ccc.tw.local;\n\n    root /var/www/app.ccc.tw.local;\n    index index.html;\n\n    location / {\n    ¦   try_files $uri $uri/ =404;\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("停用 Default 虛擬網站")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd  ./sites-enabled\nunlink default\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("啟用 Django App 虛擬網站")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ln -nfs ../sites-available/app.ccc.tw.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("檢驗目前的設定正確無誤。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("nginx -t\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("重啟 nginx 服務。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("systemctl restart nginx\nsystemclt status nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"7"}},[a("li",[s._v("驗證 Django App 虛擬網站的 HTTP 服務已能正常運作。")])]),s._v(" "),a("p",[s._v("使用 Web 瀏覽器，瀏覽網址： http://app.ccc.tw.local/ 。若一切正常，應能於瀏覽器\n看到如下「內容」之網頁。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("app.ccc.tw.local Web Site\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("RouterLink",{attrs:{to:"/_my_dev_env/macOS/Ubuntu-Install_Nginx_as_Django_Web_Server.html"}},[s._v("《以 Nginx 建置 Django Web Server 指引》")])],1),s._v(" "),a("h2",{attrs:{id:"安裝-uwsgi-服務"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-uwsgi-服務"}},[s._v("#")]),s._v(" 安裝 uWSGI 服務")]),s._v(" "),a("p",[s._v("安裝 uWSGI 服務作為 WSGI (Web Server Gateway Interface) 。")]),s._v(" "),a("p",[s._v("📚 "),a("RouterLink",{attrs:{to:"/_my_dev_env/macOS/Ubuntu-uWSGI.html"}},[s._v("《在 Ubuntu 建置 uWSGI 作業環境》")])],1),s._v(" "),a("h3",{attrs:{id:"安裝作業"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝作業"}},[s._v("#")]),s._v(" 安裝作業")]),s._v(" "),a("ol",[a("li",[s._v("安裝 uWSGI 套件。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo -H pip3 install uwsgi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo pip3 install https://projects.unbit.it/downloads/uwsgi-lts.tar.gz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("📺")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("alanjui@VB02-Ubuntu-2004:~/www/mysite$ pip3 list\nPackage                Version\n---------------------- --------------------\napturl                 0.5.2\nasgiref                3.3.1\nblinker                1.4\nBrlapi                 0.7.0\ncertifi                2019.11.28\nchardet                3.0.4\nClick                  7.0\ncolorama               0.4.3\ncommand-not-found      0.3\ncryptography           2.8\ncupshelpers            1.0\ndbus-python            1.2.16\ndefer                  1.0.6\ndistro                 1.4.0\ndistro-info            0.23ubuntu1\nDjango                 3.1.7\n....\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("alanjui@VB02-Ubuntu-2004:~/www/mysite$ which uwsgi\n/usr/bin/uwsgi\nalanjui@VB02-Ubuntu-2004:~/www/mysite$ ll /usr/bin/uwsgi\nlrwxrwxrwx 1 root root 23  3月 28 14:10 /usr/bin/uwsgi -> /etc/alternatives/uwsgi*\nalanjui@VB02-Ubuntu-2004:~/www/mysite$ ll /etc/alternatives/uwsgi\nlrwxrwxrwx 1 root root 19  3月 28 14:10 /etc/alternatives/uwsgi -> /usr/bin/uwsgi-core*\nalanjui@VB02-Ubuntu-2004:~/www/mysite$ ll /usr/bin/uwsgi-core\n-rwxr-xr-x 1 root root 935112  4月 11  2020 /usr/bin/uwsgi-core*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"驗證作業"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#驗證作業"}},[s._v("#")]),s._v(" 驗證作業")]),s._v(" "),a("p",[s._v("驗證 Web Client 傳來之 HTTP Request ，能被 uwsgi 服務接收，並轉傳至 Django App 。")]),s._v(" "),a("p",[s._v("通信路徑：\nWeb Client ⬅➡ uWSGI ⬅➡ Django App\nWeb Client ⬅➡ Web Server ⬅➡ Web Socket (Socket File) ⬅➡ uWSGI ⬅➡ Django App")]),s._v(" "),a("ol",[a("li",[s._v("建置測試用 Django App")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 建置專案目錄\ncd\nmkdir -p www/mysite && cd $_\n\n# 升級 pip3 套件管理器至最新版\npython3 -m pip3 install --upgrade pip3\n\n# 建置及啟用虛擬環境\npython3 -m venv .venv\nsource .venv/bin/activate\n\n# 安裝 Django App 所需套件\npip3 install django\n\ndjango-admin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("修訂 Django App 原始碼，使之能與 uwsgi 及 nginx 整合運作。")])]),s._v(" "),a("ul",[a("li",[s._v("下載 Django App 原始檔")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('cd /var/www\nsudo git clone alanjui@192.168.66.21:"~/workspace/django/test-100" mysite.ccc.tw.local\nsudo git config --global user.email "alanjui.1960@gmail.com"\nsudo git config --global user.name "Alan Jui"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo chown -R www-data:www-data mysite.ccc.tw.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("編輯 Django App 的設定檔")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /home/alanjui/www/mysite\nvim mysite/settings.py\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("設定 ALLOWED_HOSTS ，接收來自 host: mysite.ccc.tw.local 的 HTTP Request")])]),s._v(" "),a("p",[s._v("🔖 mysite/settings.py")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("allowed_hosts = [\n    'mysite.ccc.tw.local',\n    'localhost',\n    '127.0.0.1',\n]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("設定 static_root ，令「靜態檔」集中匯入：專案目錄下的子目錄：static_collected")])]),s._v(" "),a("p",[s._v("🔖 mysite/settings.py")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("static_root = base_dir / 'static_collected'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("【註】：目錄全路徑 /home/alanjui/www/mysite/static_collected/ 。")]),s._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[s._v("佈署 Django App 的「靜態檔案（static files）」。")])]),s._v(" "),a("p",[s._v("匯集所有靜態檔案至「靜態檔佈署目錄」：\n/home/alanjui/www/mysite/static_collected/")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("./manage.py collectstatic\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("佈署 Django App 的 Media 檔案")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir media\ncp static_collected/admin/img/search.svg media/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("建置 Nginx 虛擬網站。")])]),s._v(" "),a("ul",[a("li",[s._v("建置虛擬網站設定檔")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /var/www\nsudo ln -nfs config/mysite.ccc.tw.local.conf /etc/nginx/sites-enabled\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("🔖 mysite.ccc.tw.local")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("server {\n    listen 80;\n\n    server_name mysite.ccc.tw.local;\n\n    root /var/www/mysite.ccc.tw.local;\n    index index.html;\n\n    location / {\n    ¦   try_files $uri $uri/ =404;\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("ul",[a("li",[s._v("停用 Default 虛擬網站")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd  ./sites-enabled\nunlink default\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("啟用 Django App 虛擬網站")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ln -nfs ../sites-available/mysite.ccc.tw.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("驗證設定語法正確土")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("nginx -t\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("重啟 Nginx 服務")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("systemctl restart nginx\nsystemctl status nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("建置 uWSGI 服務。")])]),s._v(" "),a("p",[s._v("建置 uWSGI 服務設定檔： mysite_uwsgi.ini 。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /home/alanjui/www/mysite\nvim mysite_uwsgi.ini\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("🔖 mysite_uwsgi.ini")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# mysite_uwsgi.ini file\n[uwsgi]\n\n# Django-related settings\n# the base directory (full path)\nchdir           = /home/alanjui/www/mysite\n# Django's wsgi file\nmodule          = mysite.wsgi\n# the virtualenv (full path)\nhome            = /home/alanjui/.pyenv/versions/3.9.1/envs/venv-3.9.1\n\n# process-related settings\n# master\nmaster          = true\n# maximum number of worker processes\nprocesses       = 10\n# the socket (use the full path to be safe\nsocket          = /home/alanjui/www/mysite/mysite.sock\n# ... with appropriate permissions - may be needed\nchmod-socket    = 666\n# clear environment on exit\nvacuum          = true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("ol",{attrs:{start:"7"}},[a("li",[s._v("啟動 uwsgi 服務")])]),s._v(" "),a("p",[s._v("以 Emperor Mode 啟用 uWSGI 服務。")]),s._v(" "),a("ul",[a("li",[s._v("建置 Emperor Mode 服務用 vassals 目錄")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo mkdir -p /etc/uwsgi/vassals\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("啟用服務設定")])]),s._v(" "),a("p",[s._v("建立 uwsgi 設定檔的連結，放至目錄路徑中： /etc/uwsgi/vassals/")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo ln -s /home/alanjui/www/mysite/mysite_uwsgi.ini /etc/uwsgi/vassals/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("以 Emper Mode 啟用 uwsgi 服務")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("uwsgi --emperor /etc/uwsgi/vassals --uid www-data --gid www-data\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"8"}},[a("li",[s._v("驗證能存取 static 靜態檔案")])]),s._v(" "),a("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local:8000/static/admin/img/search.svg\n，確認「網頁」能見到「放大鏡圖示」。")]),s._v(" "),a("ol",{attrs:{start:"9"}},[a("li",[s._v("驗證能存取 media 靜態檔案")])]),s._v(" "),a("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local:8000/media/search.svg\n，確認「網頁」能見到「放大鏡圖示」。")]),s._v(" "),a("ol",{attrs:{start:"10"}},[a("li",[s._v("驗證非存取 static 與 media 的 HTTP Request 會被送往 Django App")])]),s._v(" "),a("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local:8000/ ，確認「網頁」能見到\n如下圖之內容。")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/django/django-app-default-home.png",alt:""}})]),s._v(" "),a("p",[s._v("📺")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("alanjui@VB02-Ubuntu-2004:~$ uwsgi --emperor /etc/uwsgi/vassals --uid www-data --gid www-data\n*** Starting uWSGI 2.0.19.1 (64bit) on [Mon Mar 29 20:30:47 2021] ***\ncompiled with version: 9.3.0 on 28 March 2021 03:49:51\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /home/alanjui\ndetected binary path: /usr/local/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\n*** WARNING: you are running uWSGI without its master process manager ***\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\n*** starting uWSGI Emperor ***\n*** has_emperor mode detected (fd: 6) ***\n[uWSGI] getting INI configuration from mysite_uwsgi.ini\n*** Starting uWSGI 2.0.19.1 (64bit) on [Mon Mar 29 20:30:47 2021] ***\ncompiled with version: 9.3.0 on 28 March 2021 03:49:51\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /etc/uwsgi/vassals\ndetected binary path: /usr/local/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\nchdir() to /home/alanjui/www/mysite\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\nlock engine: pthread robust mutexes\nthunder lock: disabled (you can enable it with --thunder-lock)\nuwsgi socket 0 bound to UNIX address /home/alanjui/www/mysite/mysite.sock fd 3\nPython version: 3.8.5 (default, Jan 27 2021, 15:41:15)  [GCC 9.3.0]\nPEP 405 virtualenv detected: /home/alanjui/www/mysite/.venv\nSet PythonHome to /home/alanjui/www/mysite/.venv\n*** Python threads support is disabled. You can enable it with --enable-threads ***\nPython main interpreter initialized at 0x55fd299c7560\nyour server socket listen backlog is limited to 100 connections\nyour mercy for graceful operations on workers is 60 seconds\nmapped 802120 bytes (783 KB) for 10 cores\n*** Operational MODE: preforking ***\nWSGI app 0 (mountpoint='') ready in 0 seconds on interpreter 0x55fd299c7560 pid: 102642 (default app)\n*** uWSGI is running in multiple interpreter mode ***\nspawned uWSGI master process (pid: 102642)\nMon Mar 29 20:30:47 2021 - [emperor] vassal mysite_uwsgi.ini has been spawned\nspawned uWSGI worker 1 (pid: 102644, cores: 1)\nMon Mar 29 20:30:47 2021 - [emperor] vassal mysite_uwsgi.ini is ready to accept requests\nspawned uWSGI worker 2 (pid: 102645, cores: 1)\nspawned uWSGI worker 3 (pid: 102646, cores: 1)\nspawned uWSGI worker 4 (pid: 102647, cores: 1)\nspawned uWSGI worker 5 (pid: 102648, cores: 1)\nspawned uWSGI worker 6 (pid: 102649, cores: 1)\nspawned uWSGI worker 7 (pid: 102650, cores: 1)\nspawned uWSGI worker 8 (pid: 102651, cores: 1)\nspawned uWSGI worker 9 (pid: 102652, cores: 1)\nspawned uWSGI worker 10 (pid: 102653, cores: 1)\n[pid: 102652|app: 0|req: 1/1] 192.168.66.21 () {44 vars in 811 bytes} [Mon Mar 29 12:31:21 2021] GET / => generated 16351 bytes in 16 msecs (HTTP/1.1 200) 5 headers in 153 bytes (1 switches on core 0)\nannouncing my loyalty to the Emperor...\nMon Mar 29 20:31:21 2021 - [emperor] vassal mysite_uwsgi.ini is now loyal\n^C[emperor] *** RAGNAROK EVOKED ***\nMon Mar 29 20:31:57 2021 - [emperor] stop the uwsgi instance mysite_uwsgi.ini\nSIGINT/SIGQUIT received...killing workers...\nMon Mar 29 12:31:57 2021 - received message 0 from emperor\nworker 1 buried after 1 seconds\nworker 2 buried after 1 seconds\nworker 3 buried after 1 seconds\nworker 4 buried after 1 seconds\nworker 5 buried after 1 seconds\nworker 6 buried after 1 seconds\nworker 7 buried after 1 seconds\nworker 8 buried after 1 seconds\nworker 9 buried after 1 seconds\nworker 10 buried after 1 seconds\ngoodbye to uWSGI.\nVACUUM: unix socket /home/alanjui/www/mysite/mysite.sock removed.\nMon Mar 29 20:31:59 2021 - [emperor] removed uwsgi instance mysite_uwsgi.ini\nMon Mar 29 20:32:00 2021 - The Emperor is buried.\nalanjui@VB02-Ubuntu-2004:~$\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br")])]),a("h2",{attrs:{id:"問題診斷與狀況排除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#問題診斷與狀況排除"}},[s._v("#")]),s._v(" 問題診斷與狀況排除")]),s._v(" "),a("h3",{attrs:{id:"解除作業系統預設之-vim"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解除作業系統預設之-vim"}},[s._v("#")]),s._v(" 解除作業系統預設之 vim")]),s._v(" "),a("p",[s._v("如下方式安裝之 VIM 套件，無法安裝「最新版」。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo apt install vim\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("若欲安裝最新版之 VIM ，可使用 GitHub 之原始碼建置。已安裝之 VIM ，可依以下方法，\n解除原先安裝及清除設定。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo apt remove vim --purge\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("📺")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("alanjui@VB02-Ubuntu-2004:~$ sudo apt remove vim --purge\n正在讀取套件清單... 完成\n正在重建相依關係\n正在讀取狀態資料... 完成\n以下套件為自動安裝，並且已經無用：\n  vim-runtime\n使用 'sudo apt autoremove' 將之移除。\n下列套件將會被【移除】：\n  vim*\n升級 0 個，新安裝 0 個，移除 1 個，有 0 個未被升級。\n此操作完成之後，會空出 3,111 kB 的磁碟空間。\n是否繼續進行 [Y/n]？ [Y/n] y\n（讀取資料庫 ... 目前共安裝了 171827 個檔案和目錄。）\n正在移除 vim (2:8.1.2269-1ubuntu5)……\nupdate-alternatives: 在自動模式下以 /usr/bin/vim.tiny 來提供 /usr/bin/vi (vi)\nupdate-alternatives: 在自動模式下以 /usr/bin/vim.tiny 來提供 /usr/bin/view (view)\nupdate-alternatives: 在自動模式下以 /usr/bin/vim.tiny 來提供 /usr/bin/ex (ex)\nupdate-alternatives: 在自動模式下以 /usr/bin/vim.tiny 來提供 /usr/bin/rview (rview)\n（讀取資料庫 ... 目前共安裝了 171818 個檔案和目錄。）\n正在清除 vim (2:8.1.2269-1ubuntu5) 的設定檔……\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"參考資料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#參考資料"}},[s._v("#")]),s._v(" 參考資料")]),s._v(" "),a("h3",{attrs:{id:"多重-python-版本建置虛擬環境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多重-python-版本建置虛擬環境"}},[s._v("#")]),s._v(" 多重 Python 版本建置虛擬環境")]),s._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://akrabat.com/creating-virtual-environments-with-pyenv/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Creating virtual environments with Pyenv"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://gist.github.com/wronk/a902185f5f8ed018263d828e1027009b",target:"_blank",rel:"noopener noreferrer"}},[s._v("Python Environment Setup"),a("OutboundLink")],1)])])])])}),[],!1,null,null,null);a.default=t.exports}}]);