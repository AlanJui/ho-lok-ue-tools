(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{387:function(s,e,n){"use strict";n.r(e);var a=n(10),t=Object(a.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"在-ubuntu-建置-uwsgi-作業環境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在-ubuntu-建置-uwsgi-作業環境"}},[s._v("#")]),s._v(" 在 Ubuntu 建置 uWSGI 作業環境")]),s._v(" "),e("h2",{attrs:{id:"摘要"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#摘要"}},[s._v("#")]),s._v(" 摘要")]),s._v(" "),e("p",[s._v("如何在 Ubuntu 作業系統，建置 uWSGI 服務，用以整合 Nginx（HTTP Server）與 Django App （Application Server）。")]),s._v(" "),e("ul",[e("li",[s._v("安裝 uWSGI 服務")]),s._v(" "),e("li",[s._v("驗證 uwsgi 能用 port 串連 Django App")]),s._v(" "),e("li",[s._v("驗證 uwsgi 能用 unix socket 串連 Django App")]),s._v(" "),e("li",[s._v("驗證 uwsgi 能與 Django App 整合運作")]),s._v(" "),e("li",[s._v("驗證 uWSGI 能依設定檔運作")])]),s._v(" "),e("h2",{attrs:{id:"安裝-uwsgi-服務"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安裝-uwsgi-服務"}},[s._v("#")]),s._v(" 安裝 uWSGI 服務")]),s._v(" "),e("p",[s._v("安裝 uWSGI 服務作為 WSGI (Web Server Gateway Interface) 。")]),s._v(" "),e("p",[s._v("📚 "),e("a",{attrs:{href:"https://uwsgi-docs.readthedocs.io/en/latest/tutorials/Django_and_nginx.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("《Setting up Django and your web server with uWSGI and nginx》"),e("OutboundLink")],1)]),s._v(" "),e("h3",{attrs:{id:"安裝作業"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安裝作業"}},[s._v("#")]),s._v(" 安裝作業")]),s._v(" "),e("ol",[e("li",[s._v("安裝 uWSGI 套件。")])]),s._v(" "),e("p",[s._v("先將已啟用之「虛擬環境」停掉。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo -H pip3 install uwsgi\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("alanjui@VB02-Ubuntu-2004:~$ sudo -H pip3 install uwsgi\nProcessing /root/.cache/pip/wheels/87/01/0f/2fc9c74a1ae010de7d8b17d90f6b39595cbb8ac5169345fcb8/uWSGI-2.0.19.1-cp38-cp38-linux_x86_64.whl\nInstalling collected packages: uwsgi\nSuccessfully installed uwsgi-2.0.19.1\nalanjui@VB02-Ubuntu-2004:~$ which uwsgi\n/usr/local/bin/uwsgi\nalanjui@VB02-Ubuntu-2004:~$ ll /usr/local/bin/uwsgi\n-rwxr-xr-x 1 root root 1341888  3月 28 15:23 /usr/local/bin/uwsgi*\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"驗證作業"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證作業"}},[s._v("#")]),s._v(" 驗證作業")]),s._v(" "),e("p",[s._v("驗證 Web Client 傳來之 HTTP Request ，能被 uwsgi 服務接收，並轉傳至\nDjango App 。")]),s._v(" "),e("p",[s._v("通信路徑：\nWeb Client ⬅➡ uWSGI ⬅➡ Django App")]),s._v(" "),e("ol",[e("li",[s._v("建置測試用 Django App")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd\nmkdir www && cd $_\npyenv virtualenv 3.9.1 venv-3.9.1\npyenv local venv-3.9.1\n~/.pyenv/versions/3.9.1/envs/venv-3.9.1/bin/python3.9 -m pip install --upgrade pip\n\npip install Django\n\ndjango-admin\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("安裝 python 套件：uwsgi。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("pip install uwsgi\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("新增 test.py 測試檔，以為「測試用 Django App」。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("vim test.py\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("🔖")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# test.py\ndef application(env, start_response):\n    start_response('200 OK', [('Content-Type','text/html')])\n    return [b\"Hello World\"]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ol",{attrs:{start:"4"}},[e("li",[s._v("使用 uwsgi 啟動「測試用 Django App」。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("uwsgi --http :8000 --wsgi-file test.py\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("(venv-3.9.1) alanjui@VB02-Ubuntu-2004:~/www/mysite$ uwsgi --http :8000 --wsgi-file test.py\n*** Starting uWSGI 2.0.19.1 (64bit) on [Fri Mar 26 21:00:15 2021] ***\ncompiled with version: 9.3.0 on 26 March 2021 12:58:00\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /home/alanjui/www/mysite\ndetected binary path: /home/alanjui/.pyenv/versions/3.9.1/envs/venv-3.9.1/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\n*** WARNING: you are running uWSGI without its master process manager ***\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\nlock engine: pthread robust mutexes\nthunder lock: disabled (you can enable it with --thunder-lock)\nuWSGI http bound on :8000 fd 4\nspawned uWSGI http 1 (pid: 72818)\nuwsgi socket 0 bound to TCP address 127.0.0.1:41827 (port auto-assigned) fd 3\nPython version: 3.9.1 (default, Mar 26 2021, 13:50:53)  [GCC 9.3.0]\n*** Python threads support is disabled. You can enable it with --enable-threads ***\nPython main interpreter initialized at 0x556dc9fcb0c0\nyour server socket listen backlog is limited to 100 connections\nyour mercy for graceful operations on workers is 60 seconds\nmapped 72920 bytes (71 KB) for 1 cores\n*** Operational MODE: single process ***\nWSGI app 0 (mountpoint='') ready in 0 seconds on interpreter 0x556dc9fcb0c0 pid: 72776 (default app)\n*** uWSGI is running in multiple interpreter mode ***\nspawned uWSGI worker 1 (and the only) (pid: 72776, cores: 1)\n[pid: 72776|app: 0|req: 1/1] 192.168.66.21 () {38 vars in 720 bytes} [Fri Mar 26 21:00:24 2021] GET / => generated 11 bytes in 0 msecs (HTTP/1.1 200) 1 headers in 44 bytes (1 switches on core 0)\n[pid: 72776|app: 0|req: 2/2] 192.168.66.21 () {38 vars in 679 bytes} [Fri Mar 26 21:00:24 2021] GET /favicon.ico => generated 11 bytes in 0 msecs (HTTP/1.1 200) 1 headers in 44 bytes (1 switches on core 0)\n[pid: 72776|app: 0|req: 3/3] 192.168.66.21 () {38 vars in 722 bytes} [Fri Mar 26 21:00:37 2021] GET / => generated 11 bytes in 0 msecs (HTTP/1.1 200) 1 headers in 44 bytes (1 switches on core 0)\n[pid: 72776|app: 0|req: 4/4] 192.168.66.21 () {38 vars in 683 bytes} [Fri Mar 26 21:00:37 2021] GET /favicon.ico => generated 11 bytes in 0 msecs (HTTP/1.1 200) 1 headers in 44 bytes (1 switches on core 0)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])]),e("ol",{attrs:{start:"5"}},[e("li",[s._v("驗證 Web 瀏覽器，能自「測試用 Django App」傳來文字： Hello World 。")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/ ，確認「網頁」能見到文字： Hello World 。")]),s._v(" "),e("h2",{attrs:{id:"驗證-port-能串連-django-app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證-port-能串連-django-app"}},[s._v("#")]),s._v(" 驗證 Port 能串連 Django App")]),s._v(" "),e("p",[s._v("驗證 Web Client 傳來之 HTTP Request ，Web Server（nginx 服務）能依\n「Request」判別：該由 nginx 取出「靜態檔」，供 Web Client 下載；亦\n或是透過 port 交由 uwsgi 將 HTTP Request 轉交 Django App 處理。")]),s._v(" "),e("p",[s._v("通信路徑：\nWeb Client ⬅➡ Web Server ⬅➡ Web Socket (Port) ⬅➡ uWSGI ⬅➡ Django App")]),s._v(" "),e("p",[s._v("【處理規則】：")]),s._v(" "),e("p",[s._v("(1) 若 HTTP Request 要「取用 static 靜態檔」，由 nginx 服務處理：\nstatic: .html / .css / .js / .png / .jpg")]),s._v(" "),e("p",[s._v("(2) 若 HTTP Request 要「取用 media 靜態檔」，由 nginx 服務處理：\nmedia: image 檔案")]),s._v(" "),e("p",[s._v("(3) 以上皆非之 HTTP Request，透過 Web Socket（Port）轉交 uWSGI ，傳遞予 Django App 處理。")]),s._v(" "),e("h3",{attrs:{id:"設定作業"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#設定作業"}},[s._v("#")]),s._v(" 設定作業")]),s._v(" "),e("ol",[e("li",[s._v("建立 mysite.ccc.tw.local 虛擬網站設定檔。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /home/alanjui/www/mysite\nvim mysite.ccc.tw.local.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("🔖 mysite.ccc.tw.local.conf")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# the upstream component nginx needs to connect to\nupstream django {\n    # server unix:///path/to/your/mysite/mysite.sock; # for a file socket\n    server 127.0.0.1:8001;  # for a web port socket\n}\n\nserver {\n    # the port mysite will be served on\n    # listen 8000;\n    # the domain name it will serve for\n    server_name mysite.ccc.tw.local; # substitute your machine's IP address or FQDN\n    charset utf-8;\n\n    # max upload size\n    client_max_body_size 75M; # adjust to taste\n\n    # Django media\n    location /media {\n        alias /home/alanjui/www/mysite/media;\n    }\n\n    location /static {\n        alias /home/alanjui/www/mysite/static_collected;\n    }\n\n    # Finally, send all non-media requests to the Djang server.\n    location / {\n        uwsgi_pass  django;\n        include     /etc/nginx/uwsgi_params;\n    }\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("啟用 mysite.ccc.tw.local 虛擬網站。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /etc/nginx/sites-enabled\nsudo ln -nfs /home/alanjui/www/mysite/mysite.ccc.tw.local.conf\nsudo nginx -t\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("設定「登入帳號」屬 www-data 群組。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo usermod -aG www-data $USER\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"驗證作業-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證作業-2"}},[s._v("#")]),s._v(" 驗證作業")]),s._v(" "),e("p",[s._v("驗證 Web Client 傳來之 HTTP Request ，Web Server（nginx 服務）能依\n「Request」判別：該由 nginx 取出「靜態檔」，供 Web Client 下載；亦\n或是透過 port 交由 uwsgi 將 HTTP Request 轉交 Django App 處理。")]),s._v(" "),e("p",[s._v("通信路徑：\nWeb Client ⬅➡ Web Server ⬅➡ Web Socket (Port) ⬅➡ uWSGI ⬅➡ Django App")]),s._v(" "),e("ol",[e("li",[s._v("設定 Django App 的「靜態檔佈署目錄」，用以彙總 Django App 所有的「靜態檔案」。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd ~/www/mysite/\nvim mysite/settngs.py\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("🔖 mysite/settngs.py")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("STATIC_ROOT = BASE_DIR / 'static_collected'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("佈署 Django App 的「靜態檔案（static files）」。")])]),s._v(" "),e("p",[s._v("匯集所有靜態檔案至「靜態檔佈署目錄」：\n/home/alanjui/www/mysite/static_collected/")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("./manage.py collectstatic\n\ncp static_collected/admin/img/search.svg media/\n\nuwsgi --socket :8001 --wsgi-file test.py\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("驗證能存取 static 靜態檔案")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/static/admin/img/search.svg\n，確認「網頁」能見到「放大鏡圖示」。")]),s._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[s._v("驗證能存取 media 靜態檔案")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/media/search.svg\n，確認「網頁」能見到「放大鏡圖示」。")]),s._v(" "),e("ol",{attrs:{start:"5"}},[e("li",[s._v("驗證非存取 static 與 media 的 HTTP Request 會被送往 Django App")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/ ，確認「網頁」能見到\n文字： Hello World 。")]),s._v(" "),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("(venv-3.9.1) alanjui@VB02-Ubuntu-2004:~/www/mysite$ uwsgi --socket :8001 --wsgi-file test.py\n*** Starting uWSGI 2.0.19.1 (64bit) on [Fri Mar 26 22:46:53 2021] ***\ncompiled with version: 9.3.0 on 26 March 2021 12:58:00\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /home/alanjui/www/mysite\ndetected binary path: /home/alanjui/.pyenv/versions/3.9.1/envs/venv-3.9.1/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\n*** WARNING: you are running uWSGI without its master process manager ***\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\nlock engine: pthread robust mutexes\nthunder lock: disabled (you can enable it with --thunder-lock)\nuwsgi socket 0 bound to TCP address :8001 fd 3\nPython version: 3.9.1 (default, Mar 26 2021, 13:50:53)  [GCC 9.3.0]\n*** Python threads support is disabled. You can enable it with --enable-threads ***\nPython main interpreter initialized at 0x564b57e0bac0\nyour server socket listen backlog is limited to 100 connections\nyour mercy for graceful operations on workers is 60 seconds\nmapped 72920 bytes (71 KB) for 1 cores\n*** Operational MODE: single process ***\nWSGI app 0 (mountpoint='') ready in 0 seconds on interpreter 0x564b57e0bac0 pid: 75124 (default app)\n*** uWSGI is running in multiple interpreter mode ***\nspawned uWSGI worker 1 (and the only) (pid: 75124, cores: 1)\n[pid: 75124|app: 0|req: 1/1] 192.168.66.21 () {42 vars in 787 bytes} [Fri Mar 26 22:47:21 2021] GET / => generated 11 bytes in 0 msecs (HTTP/1.1 200) 1 headers in 44 bytes (1 switches on core 0)\n[pid: 75124|app: 0|req: 2/2] 192.168.66.21 () {42 vars in 751 bytes} [Fri Mar 26 22:47:21 2021] GET /favicon.ico => generated 11 bytes in 0 msecs (HTTP/1.1 200) 1 headers in 44 bytes (1 switches on core 0)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br")])]),e("h2",{attrs:{id:"驗證-unix-socket-能串連-django-app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證-unix-socket-能串連-django-app"}},[s._v("#")]),s._v(" 驗證 Unix Socket 能串連 Django App")]),s._v(" "),e("p",[s._v("驗證 Web Client 傳來之 HTTP Request ，Web Server（nginx 服務）能依\n「Request」判別：該由 nginx 取出「靜態檔」，供 Web Client 下載；亦\n或是透過 Unix Socket (File Socket) 交由 uwsgi 將 HTTP Request 轉交 Django App 處理。")]),s._v(" "),e("p",[s._v("通信路徑：\nWeb Client ⬅➡ Web Server ⬅➡ Web Socket (Socket File) ⬅➡ uWSGI ⬅➡ Django App")]),s._v(" "),e("h3",{attrs:{id:"設定作業-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#設定作業-2"}},[s._v("#")]),s._v(" 設定作業")]),s._v(" "),e("ol",[e("li",[s._v("變更 mysite 虛擬網站設定，將 socket 改用 unix socket (file socket)")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("upstream django {\n    # server unix:///path/to/your/mysite/mysite.sock; # for a file socket\n    # server 127.0.0.1:8001;  # for a web port socket\n    server unix:///run/uwsgi/mysite.sock;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("設定 /run/uwsgi 目錄及權限。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo mkdir /run/uwsgi\nsudo chown $USER:www-data /run/uwsgi\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"驗證作業-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證作業-3"}},[s._v("#")]),s._v(" 驗證作業")]),s._v(" "),e("ol",[e("li",[s._v("重啟 nginx 服務。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl restart nginx\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("重啟 uWSGI 服務。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("uwsgi --socket mysite.sock --wsgi-file test.py --chmod-socket=666\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("驗證 Web Client 能連線到 Django App ，取得「網頁」內容。")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/ ，確認「網頁」能見到\n文字： Hello World 。")]),s._v(" "),e("p",[s._v("【註】： 以上測試若發生：502 Bad Gateway 錯誤，可查 Log 紀錄，是否同下所示範例。\n若是的話，則問題很可能是因權限不足所導致：\nconnect() to unix:///path/to/your/mysite/mysite.sock failed (13: Permission\ndenied) 。")]),s._v(" "),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("(venv-3.9.1) alanjui@VB02-Ubuntu-2004:~/www/mysite$ uwsgi --socket mysite.sock --wsgi-file test.py\n*** Starting uWSGI 2.0.19.1 (64bit) on [Fri Mar 26 23:32:56 2021] ***\ncompiled with version: 9.3.0 on 26 March 2021 12:58:00\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /home/alanjui/www/mysite\ndetected binary path: /home/alanjui/.pyenv/versions/3.9.1/envs/venv-3.9.1/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\n*** WARNING: you are running uWSGI without its master process manager ***\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\nlock engine: pthread robust mutexes\nthunder lock: disabled (you can enable it with --thunder-lock)\nuwsgi socket 0 bound to UNIX address mysite.sock fd 3\nPython version: 3.9.1 (default, Mar 26 2021, 13:50:53)  [GCC 9.3.0]\n*** Python threads support is disabled. You can enable it with --enable-threads ***\nPython main interpreter initialized at 0x562a24fceac0\nyour server socket listen backlog is limited to 100 connections\nyour mercy for graceful operations on workers is 60 seconds\nmapped 72920 bytes (71 KB) for 1 cores\n*** Operational MODE: single process ***\nWSGI app 0 (mountpoint='') ready in 0 seconds on interpreter 0x562a24fceac0 pid: 75507 (default app)\n*** uWSGI is running in multiple interpreter mode ***\nspawned uWSGI worker 1 (and the only) (pid: 75507, cores: 1)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br")])]),e("h2",{attrs:{id:"驗證-uwsgi-能與-django-app-整合運作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證-uwsgi-能與-django-app-整合運作"}},[s._v("#")]),s._v(" 驗證 uWSGI 能與 Django App 整合運作")]),s._v(" "),e("p",[s._v("將上述「測試用 Django App」改用實際之 Django App 復行測試。")]),s._v(" "),e("p",[s._v("通信路徑：\nWeb Client ⬅➡ Web Server ⬅➡ Web Socket (Socket File) ⬅➡ uWSGI ⬅➡ Django App")]),s._v(" "),e("h3",{attrs:{id:"設定-django-app-原始碼作業"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#設定-django-app-原始碼作業"}},[s._v("#")]),s._v(" 設定 Django App 原始碼作業")]),s._v(" "),e("p",[s._v("修訂原始碼使之與 uwsgi 整合")]),s._v(" "),e("ol",[e("li",[s._v("修訂 Django App 原始碼，使之能與 uwsgi 及 nginx 整合運作。")])]),s._v(" "),e("ul",[e("li",[s._v("編輯 Django App 的設定檔")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /home/alanjui/www/mysite\nvim mysite/settings.py\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("設定 ALLOWED_HOSTS ，接收來自 host: mysite.ccc.tw.local 的 HTTP Request")])]),s._v(" "),e("p",[s._v("🔖 mysite/settings.py")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ALLOWED_HOSTS = [\n    'mysite.ccc.tw.local',\n    'localhost',\n    '127.0.0.1',\n]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ul",[e("li",[s._v("設定 STATIC_ROOT ，令「靜態檔」集中匯入：專案目錄下的子目錄：static_collected")])]),s._v(" "),e("p",[s._v("🔖 mysite/settings.py")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("STATIC_ROOT = BASE_DIR / 'static_collected'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("【註】：目錄全路徑 /home/alanjui/www/mysite/static_collected/ 。")]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[s._v("佈署 Django App 的「靜態檔案（static files）」。")])]),s._v(" "),e("p",[s._v("匯集所有靜態檔案至「靜態檔佈署目錄」：\n/home/alanjui/www/mysite/static_collected/")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("./manage.py collectstatic\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("佈署 Django App 的 Media 檔案")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cp static_collected/admin/img/search.svg media/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"建置-uwsgi-服務設定檔"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#建置-uwsgi-服務設定檔"}},[s._v("#")]),s._v(" 建置 uWSGI 服務設定檔")]),s._v(" "),e("ol",[e("li",[s._v("建置 uWSGI 服務設定檔： mysite_uwsgi.ini 。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /home/alanjui/www/mysite\nvim mysite_uwsgi.ini\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("🔖 mysite_uwsgi.ini")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# mysite_uwsgi.ini file\n[uwsgi]\nproject = mysite\nuid = alanjui\nbase = /home/%(uid)\n\n# Django-related settings\n# the base directory (full path)\n#chdir           = /home/alanjui/www/mysite\nchdir           = %(base)/www/%(project)\n# Django's wsgi file\nmodule          = mysite.wsgi\n# the virtualenv (full path)\n#home            = /home/alanjui/.pyenv/versions/venv-3.9.1\n#home            = /home/alanjui/.pyenv/versions/3.9.1/envs/venv-3.9.1\nhome            = %(chdir)/.venv\n\n# process-related settings\n# master\nmaster          = true\n# maximum number of worker processes\nprocesses       = 10\n# the socket (use the full path to be safe\n# socket          = /home/alanjui/www/mysite/mysite.sock\nsocket          = /run/uwsgi/%(project).sock\n# ... with appropriate permissions - may be needed\n#chmod-socket    = 664\nchmod-socket    = 666\n# clear environment on exit\nvacuum          = true\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br")])]),e("h3",{attrs:{id:"驗證作業-4"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證作業-4"}},[s._v("#")]),s._v(" 驗證作業")]),s._v(" "),e("ol",[e("li",[s._v("啟動 uwsgi 服務。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("uwsgi --ini mysite_uwsgi.ini\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("驗證能存取 static 靜態檔案")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/static/admin/img/search.svg\n，確認「網頁」能見到「放大鏡圖示」。")]),s._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[s._v("驗證能存取 media 靜態檔案")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/media/search.svg\n，確認「網頁」能見到「放大鏡圖示」。")]),s._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[s._v("驗證非存取 static 與 media 的 HTTP Request 會被送往 Django App")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/ ，確認「網頁」能見到\n如下圖之內容。")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/django/django-app-default-home.png",alt:""}})]),s._v(" "),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("(venv-3.9.1) alanjui@VB02-Ubuntu-2004:~/www/mysite$ uwsgi --ini mysite_uwsgi.ini\n[uWSGI] getting INI configuration from mysite_uwsgi.ini\n*** Starting uWSGI 2.0.19.1 (64bit) on [Sat Mar 27 21:29:54 2021] ***\ncompiled with version: 9.3.0 on 26 March 2021 12:58:00\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /home/alanjui/www/mysite\ndetected binary path: /home/alanjui/.pyenv/versions/3.9.1/envs/venv-3.9.1/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\nchdir() to /home/alanjui/www/mysite\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\nlock engine: pthread robust mutexes\nthunder lock: disabled (you can enable it with --thunder-lock)\nuwsgi socket 0 bound to UNIX address /home/alanjui/www/mysite/mysite.sock fd 3\nPython version: 3.9.1 (default, Mar 26 2021, 13:50:53)  [GCC 9.3.0]\nPEP 405 virtualenv detected: /home/alanjui/.pyenv/versions/3.9.1/envs/venv-3.9.1\nSet PythonHome to /home/alanjui/.pyenv/versions/3.9.1/envs/venv-3.9.1\n*** Python threads support is disabled. You can enable it with --enable-threads ***\nPython main interpreter initialized at 0x55a335b993b0\nyour server socket listen backlog is limited to 100 connections\nyour mercy for graceful operations on workers is 60 seconds\nmapped 802120 bytes (783 KB) for 10 cores\n*** Operational MODE: preforking ***\nWSGI app 0 (mountpoint='') ready in 0 seconds on interpreter 0x55a335b993b0 pid: 85887 (default app)\n*** uWSGI is running in multiple interpreter mode ***\nspawned uWSGI master process (pid: 85887)\nspawned uWSGI worker 1 (pid: 85930, cores: 1)\nspawned uWSGI worker 2 (pid: 85931, cores: 1)\nspawned uWSGI worker 3 (pid: 85932, cores: 1)\nspawned uWSGI worker 4 (pid: 85933, cores: 1)\nspawned uWSGI worker 5 (pid: 85934, cores: 1)\nspawned uWSGI worker 6 (pid: 85935, cores: 1)\nspawned uWSGI worker 7 (pid: 85936, cores: 1)\nspawned uWSGI worker 8 (pid: 85937, cores: 1)\nspawned uWSGI worker 9 (pid: 85938, cores: 1)\nspawned uWSGI worker 10 (pid: 85939, cores: 1)\n[pid: 85932|app: 0|req: 1/1] 192.168.66.21 () {44 vars in 818 bytes} [Sat Mar 27 13:32:07 2021] GET / => generated 16351 bytes in 17 msecs (HTTP/1.1 200) 5 headers in 153 bytes (1 switches on core 0)\n^CSIGINT/SIGQUIT received...killing workers...\nworker 1 buried after 1 seconds\nworker 2 buried after 1 seconds\nworker 3 buried after 1 seconds\nworker 4 buried after 1 seconds\nworker 5 buried after 1 seconds\nworker 6 buried after 1 seconds\nworker 7 buried after 1 seconds\nworker 8 buried after 1 seconds\nworker 9 buried after 1 seconds\nworker 10 buried after 1 seconds\ngoodbye to uWSGI.\nVACUUM: unix socket /home/alanjui/www/mysite/mysite.sock removed.\n(venv-3.9.1) alanjui@VB02-Ubuntu-2004:~/www/mysite$\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br")])]),e("h2",{attrs:{id:"驗證作業系統預設-uwsgi-能串連-django-app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證作業系統預設-uwsgi-能串連-django-app"}},[s._v("#")]),s._v(" 驗證作業系統預設 uwsgi 能串連 Django App")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("停用 Python 虛擬環境")])]),s._v(" "),e("li",[e("p",[s._v("切換目錄至「家目錄」。")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("使用作業系統預設 uwsgi 與 Django App 整合作業。")])]),s._v(" "),e("p",[s._v("此處 uwsgi 安裝路徑： /usr/local/bin/uwsgi")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("uwsgi --ini [/Path/to/uwsgi_config.ini]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("alanjui@VB02-Ubuntu-2004:~$ uwsgi --ini /home/alanjui/www/mysite/mysite_uwsgi.ini\n[uWSGI] getting INI configuration from /home/alanjui/www/mysite/mysite_uwsgi.ini\n*** Starting uWSGI 2.0.19.1 (64bit) on [Sun Mar 28 15:28:27 2021] ***\ncompiled with version: 9.3.0 on 28 March 2021 03:49:51\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /home/alanjui\ndetected binary path: /usr/local/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\nchdir() to /home/alanjui/www/mysite\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\nlok engine: pthread robust mutexes\nthunder lock: disabled (you can enable it with --thunder-lock)\nuwsgi socket 0 bound to UNIX address /home/alanjui/www/mysite/mysite.sock fd 3\nPython version: 3.8.5 (default, Jan 27 2021, 15:41:15)  [GCC 9.3.0]\nPEP 405 virtualenv detected: /home/alanjui/www/mysite/.venv\nSet PythonHome to /home/alanjui/www/mysite/.venv\n*** Python threads support is disabled. You can enable it with --enable-threads ***\nPython main interpreter initialized at 0x561392070640\nyour server socket listen backlog is limited to 100 connections\nyour mercy for graceful operations on workers is 60 seconds\nmapped 802120 bytes (783 KB) for 10 cores\n*** Operational MODE: preforking ***\nWSGI app 0 (mountpoint='') ready in 0 seconds on interpreter 0x561392070640 pid: 101202 (default app)\n*** uWSGI is running in multiple interpreter mode ***\nspawned uWSGI master process (pid: 101202)\nspawned uWSGI worker 1 (pid: 101204, cores: 1)\nspawned uWSGI worker 2 (pid: 101205, cores: 1)\nspawned uWSGI worker 3 (pid: 101206, cores: 1)\nspawned uWSGI worker 4 (pid: 101207, cores: 1)\nspawned uWSGI worker 5 (pid: 101208, cores: 1)\nspawned uWSGI worker 6 (pid: 101209, cores: 1)\nspawned uWSGI worker 7 (pid: 101210, cores: 1)\nspawned uWSGI worker 8 (pid: 101211, cores: 1)\nspawned uWSGI worker 9 (pid: 101212, cores: 1)\nspawned uWSGI worker 10 (pid: 101213, cores: 1)\n[pid: 101204|app: 0|req: 1/1] 192.168.66.21 () {42 vars in 787 bytes} [Sun Mar 28 07:28:54 2021] GET / => generated 16351 bytes in 17 msecs (HTTP/1.1 200) 5 headers in 153 bytes (1 switches on core 0)\nNot Found: /favicon.ico\n[pid: 101205|app: 0|req: 1/2] 192.168.66.21 () {42 vars in 751 bytes} [Sun Mar 28 07:28:54 2021] GET /favicon.ico => generated 1982 bytes in 20 msecs (HTTP/1.1 404) 5 headers in 159 bytes (1 switches on core 0)\n^CSIGINT/SIGQUIT received...killing workers...\nworker 1 buried after 1 seconds\nworker 2 buried after 1 seconds\nworker 3 buried after 1 seconds\nworker 4 buried after 1 seconds\nworker 5 buried after 1 seconds\nworker 6 buried after 1 seconds\nworker 7 buried after 1 seconds\nworker 8 buried after 1 seconds\nworker 9 buried after 1 seconds\nworker 10 buried after 1 seconds\ngoodbye to uWSGI.\nVACUUM: unix socket /home/alanjui/www/mysite/mysite.sock removed.\nalanjui@VB02-Ubuntu-2004:~$\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br")])]),e("h2",{attrs:{id:"驗證-emperor-mode-能串連-django-app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證-emperor-mode-能串連-django-app"}},[s._v("#")]),s._v(" 驗證 Emperor Mode 能串連 Django App")]),s._v(" "),e("p",[s._v("以 Emperor Mode ，執行 uwsgi 。測試此運作模式，能與 Django App 整合運作。")]),s._v(" "),e("h3",{attrs:{id:"建置作業"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#建置作業"}},[s._v("#")]),s._v(" 建置作業")]),s._v(" "),e("ol",[e("li",[s._v("建置 vassals 目錄")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo mkdir -p /etc/uwsgi/vassals\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("建立 uwsgi 設定檔的連結，放至目錄路徑中： /etc/uwsgi/vassals/")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo ln -s /home/alanjui/www/mysite/mysite_uwsgi.ini /etc/uwsgi/vassals/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo mkdir -p /etc/uwsgi/u\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("要求 uwsgi 服務以 emperor mode 作業")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("uwsgi --emperor /etc/uwsgi/vassals --uid www-data --gid www-data\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("alanjui@VB02-Ubuntu-2004:~$ uwsgi --emperor /etc/uwsgi/vassals --uid www-data --gid www-data\n*** Starting uWSGI 2.0.19.1 (64bit) on [Sun Mar 28 20:44:21 2021] ***\ncompiled with version: 9.3.0 on 28 March 2021 03:49:51\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /home/alanjui\ndetected binary path: /usr/local/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\n*** WARNING: you are running uWSGI without its master process manager ***\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\n*** starting uWSGI Emperor ***\n*** has_emperor mode detected (fd: 6) ***\n[uWSGI] getting INI configuration from mysite_uwsgi.ini\n*** Starting uWSGI 2.0.19.1 (64bit) on [Sun Mar 28 20:44:21 2021] ***\ncompiled with version: 9.3.0 on 28 March 2021 03:49:51\nos: Linux-5.8.0-48-generic #54~20.04.1-Ubuntu SMP Sat Mar 20 13:40:25 UTC 2021\nnodename: VB02-Ubuntu-2004\nmachine: x86_64\nclock source: unix\ndetected number of CPU cores: 2\ncurrent working directory: /etc/uwsgi/vassals\ndetected binary path: /usr/local/bin/uwsgi\n!!! no internal routing support, rebuild with pcre support !!!\nchdir() to /home/alanjui/www/mysite\nyour processes number limit is 15511\nyour memory page size is 4096 bytes\ndetected max file descriptor number: 1024\nlock engine: pthread robust mutexes\nthunder lock: disabled (you can enable it with --thunder-lock)\nuwsgi socket 0 bound to UNIX address /home/alanjui/www/mysite/mysite.sock fd 3\nPython version: 3.8.5 (default, Jan 27 2021, 15:41:15)  [GCC 9.3.0]\nPEP 405 virtualenv detected: /home/alanjui/www/mysite/.venv\nSet PythonHome to /home/alanjui/www/mysite/.venv\n*** Python threads support is disabled. You can enable it with --enable-threads ***\nPython main interpreter initialized at 0x55e54bc1a560\nyour server socket listen backlog is limited to 100 connections\nyour mercy for graceful operations on workers is 60 seconds\nmapped 802120 bytes (783 KB) for 10 cores\n*** Operational MODE: preforking ***\nWSGI app 0 (mountpoint='') ready in 0 seconds on interpreter 0x55e54bc1a560 pid: 101572 (default app)\n*** uWSGI is running in multiple interpreter mode ***\nspawned uWSGI master process (pid: 101572)\nSun Mar 28 20:44:21 2021 - [emperor] vassal mysite_uwsgi.ini has been spawned\nspawned uWSGI worker 1 (pid: 101575, cores: 1)\nspawned uWSGI worker 2 (pid: 101576, cores: 1)\nSun Mar 28 20:44:21 2021 - [emperor] vassal mysite_uwsgi.ini is ready to accept requests\nspawned uWSGI worker 3 (pid: 101577, cores: 1)\nspawned uWSGI worker 4 (pid: 101578, cores: 1)\nspawned uWSGI worker 5 (pid: 101579, cores: 1)\nspawned uWSGI worker 6 (pid: 101580, cores: 1)\nspawned uWSGI worker 7 (pid: 101581, cores: 1)\nspawned uWSGI worker 8 (pid: 101582, cores: 1)\nspawned uWSGI worker 9 (pid: 101583, cores: 1)\nspawned uWSGI worker 10 (pid: 101584, cores: 1)\n[pid: 101582|app: 0|req: 1/1] 192.168.66.21 () {44 vars in 818 bytes} [Sun Mar 28 12:44:55 2021] GET / => generated 16351 bytes in 16 msecs (HTTP/1.1 200) 5 headers in 153 bytes (1 switches on core 0)\nannouncing my loyalty to the Emperor...\nSun Mar 28 20:44:55 2021 - [emperor] vassal mysite_uwsgi.ini is now loyal\n\n^C[emperor] *** RAGNAROK EVOKED ***\nSun Mar 28 20:45:48 2021 - [emperor] stop the uwsgi instance mysite_uwsgi.ini\nSIGINT/SIGQUIT received...killing workers...\nSun Mar 28 12:45:48 2021 - received message 0 from emperor\nworker 1 buried after 1 seconds\nworker 2 buried after 1 seconds\nworker 3 buried after 1 seconds\nworker 4 buried after 1 seconds\nworker 5 buried after 1 seconds\nworker 6 buried after 1 seconds\nworker 7 buried after 1 seconds\nworker 8 buried after 1 seconds\nworker 9 buried after 1 seconds\nworker 10 buried after 1 seconds\ngoodbye to uWSGI.\nVACUUM: unix socket /home/alanjui/www/mysite/mysite.sock removed.\nSun Mar 28 20:45:50 2021 - [emperor] removed uwsgi instance mysite_uwsgi.ini\nSun Mar 28 20:45:51 2021 - The Emperor is buried.\nalanjui@VB02-Ubuntu-2004:~$\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br")])]),e("h3",{attrs:{id:"驗證作業-5"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#驗證作業-5"}},[s._v("#")]),s._v(" 驗證作業")]),s._v(" "),e("ol",[e("li",[s._v("驗證能存取 static 靜態檔案")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/static/admin/img/search.svg\n，確認「網頁」能見到「對放大鏡圖示」。")]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[s._v("驗證能存取 media 靜態檔案")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/media/search.svg\n，確認「網頁」能見到「放大鏡圖示」。")]),s._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[s._v("驗證非存取 static 與 media 的 HTTP Request 會被送往 Django App")])]),s._v(" "),e("p",[s._v("在 Web 瀏覽器，瀏覽網址： http://mysite.ccc.tw.local/ ，確認「網頁」能見到\n如下圖之內容。")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/django/django-app-default-home.png",alt:""}})]),s._v(" "),e("h2",{attrs:{id:"啟用-uwsgi-服務"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#啟用-uwsgi-服務"}},[s._v("#")]),s._v(" 啟用 uwsgi 服務")]),s._v(" "),e("p",[s._v("設定 uwsgi 以「systemd 服務」模式運作，能於開機後自動啟動，以 Empermor Mode\n模式運作。")]),s._v(" "),e("ol",[e("li",[s._v("建立 systemd 服務設定檔。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo su\nvim /etc/systemd/system/uwsgi.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("🔖 uwsgi.service")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[Unit]\nDescription=uWSGI Empermor Mode Service\n\n[Service]\nExecStartPre=/bin/bash -c "mkdir -p /run/uwsgi; chown alanjui:www-data /run/uwsgi"\nExecStart=/usr/local/bin/uwsgi --emperor /etc/uwsgi/apps-enabled --uid alanjui --gid www-data\nRestart=always\nKillsignal=SIGQUIT\nType=notify\nNotifyAccess=all\n\n[Install]\nWantedBy=multi-user.target\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("檢查有無其它 uwsgi 服務啟用，若有，則先予停用。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl status uwsgi\n\nsudo sytemctl stop uwsgi\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("啟用服務")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl enable uwsgi\n\nsudo systemctl start uwsgi\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('alanjui@VB02-Ubuntu-2004:/etc/uwsgi/apps-enabled$ sudo systemctl enable uwsgi\nSynchronizing state of uwsgi.service with SysV service script with /lib/systemd/systemd-sysv-install.\nExecuting: /lib/systemd/systemd-sysv-install enable uwsgi\nCreated symlink /etc/systemd/system/multi-user.target.wants/uwsgi.service → /etc/systemd/system/uwsgi.service.\n\nalanjui@VB02-Ubuntu-2004:~$ sudo systemctl start uwsgi\n\nalanjui@VB02-Ubuntu-2004:~$ sudo systemctl status uwsgi\n● uwsgi.service - uWSGI Empermor Mode Service\n     Loaded: loaded (/etc/systemd/system/uwsgi.service; enabled; vendor preset: enabled)\n     Active: active (running) since Tue 2021-03-30 11:36:42 CST; 10s ago\n    Process: 1674 ExecStartPre=/bin/bash -c mkdir -p /run/uwsgi; chown alanjui:www-data /run/uwsgi (code=exited, status=0/SUCCESS)\n   Main PID: 1677 (uwsgi)\n     Status: "The Emperor is governing 1 vassals"\n      Tasks: 12 (limit: 4653)\n     Memory: 47.3M\n     CGroup: /system.slice/uwsgi.service\n             ├─1677 /usr/local/bin/uwsgi --emperor /etc/uwsgi/apps-enabled --uid alanjui --gid www-data\n             ├─1678 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1680 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1681 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1682 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1683 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1684 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1685 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1686 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1687 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             ├─1688 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n             └─1689 /usr/local/bin/uwsgi --ini mysite_uwsgi.ini\n\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 2 (pid: 1681, cores: 1)\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 3 (pid: 1682, cores: 1)\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 4 (pid: 1683, cores: 1)\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 5 (pid: 1684, cores: 1)\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 6 (pid: 1685, cores: 1)\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 7 (pid: 1686, cores: 1)\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 8 (pid: 1687, cores: 1)\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1677]: Tue Mar 30 11:36:42 2021 - [emperor] vassal mysite_uwsgi.ini is ready to accept requests\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 9 (pid: 1688, cores: 1)\n 3月 30 11:36:42 VB02-Ubuntu-2004 uwsgi[1678]: spawned uWSGI worker 10 (pid: 1689, cores: 1)\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br")])]),e("h2",{attrs:{id:"問題診斷與狀況排除"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#問題診斷與狀況排除"}},[s._v("#")]),s._v(" 問題診斷與狀況排除")]),s._v(" "),e("h3",{attrs:{id:"瀏覽異常-log"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#瀏覽異常-log"}},[s._v("#")]),s._v(" 瀏覽異常 Log")]),s._v(" "),e("p",[s._v("使用 systemctl 指令，欲啟動 uwsgi 服務。若結果失敗，可用以下指令瀏覽 Log ，診斷\n問題可能導因。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("journalctl -xe\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("📺")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("root@VB02-Ubuntu-2004:/home/alanjui# systemctl start emperor.uwsgi.service\nJob for emperor.uwsgi.service failed because the control process exited with error code.\nSee \"systemctl status emperor.uwsgi.service\" and \"journalctl -xe\" for details.\n\nroot@VB02-Ubuntu-2004:/home/alanjui# journalctl -xe\n--\n-- An ExecStart= process belonging to unit emperor.uwsgi.service has exited.\n--\n-- The process' exit code is 'exited' and its exit status is 1.\n 3月 29 22:12:27 VB02-Ubuntu-2004 systemd[1]: emperor.uwsgi.service: Failed with result 'exit-cod>\n-- Subject: Unit failed\n-- Defined-By: systemd\n-- Support: http://www.ubuntu.com/support\n--\n-- The unit emperor.uwsgi.service has entered the 'failed' state with result 'exit-code'.\n 3月 29 22:12:27 VB02-Ubuntu-2004 systemd[1]: Failed to start uWSGI Emperor.\n-- Subject: 單位 emperor.uwsgi.service 已失敗\n-- Defined-By: systemd\n-- Support: http://www.ubuntu.com/support\n--\n-- 單位 emperor.uwsgi.service 已失敗。\n--\n-- 結果為 failed。\n 3月 29 22:12:28 VB02-Ubuntu-2004 systemd[1]: emperor.uwsgi.service: Scheduled restart job, resta>\n-- Subject: Automatic restarting of a unit has been scheduled\n-- Defined-By: systemd\n-- Support: http://www.ubuntu.com/support\n--\n-- Automatic restarting of the unit emperor.uwsgi.service has been scheduled, as the result for\n-- the configured Restart= setting for the unit.\n 3月 29 22:12:28 VB02-Ubuntu-2004 systemd[1]: Stopped uWSGI Emperor.\n-- Subject: 單位 emperor.uwsgi.service 已關閉結束\n-- Defined-By: systemd\n-- Support: http://www.ubuntu.com/support\n--\n-- 單位 emperor.uwsgi.service 已關閉結束。\n 3月 29 22:12:28 VB02-Ubuntu-2004 systemd[1]: emperor.uwsgi.service: Start request repeated too q>\n 3月 29 22:12:28 VB02-Ubuntu-2004 systemd[1]: emperor.uwsgi.service: Failed with result 'exit-cod>\n-- Subject: Unit failed\n-- Defined-By: systemd\n-- Support: http://www.ubuntu.com/support\n--\n-- The unit emperor.uwsgi.service has entered the 'failed' state with result 'exit-code'.\n 3月 29 22:12:28 VB02-Ubuntu-2004 systemd[1]: Failed to start uWSGI Emperor.\n-- Subject: 單位 emperor.uwsgi.service 已失敗\n-- Defined-By: systemd\n-- Support: http://www.ubuntu.com/support\n--\n-- 單位 emperor.uwsgi.service 已失敗。\n--\n-- 結果為 failed。\nlines 2374-2419/2419 (END)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br")])]),e("h2",{attrs:{id:"常用參考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用參考"}},[s._v("#")]),s._v(" 常用參考")]),s._v(" "),e("h3",{attrs:{id:"重啟-systemd-服務"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重啟-systemd-服務"}},[s._v("#")]),s._v(" 重啟 systemd 服務")]),s._v(" "),e("p",[s._v("當 systemd 的「服務設定檔」完成變更後，欲重啟服務之前，需先執行 daemon-reload 指令。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl daemon-reload\nsudo systemctl restart [Systemd_Service_Name]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"參考資料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#參考資料"}},[s._v("#")]),s._v(" 參考資料")]),s._v(" "),e("h3",{attrs:{id:"官網指引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#官網指引"}},[s._v("#")]),s._v(" 官網指引")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://uwsgi-docs.readthedocs.io/en/latest/tutorials/Django_and_nginx.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Setting up Django and your web server with uWSGI and nginx"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://uwsgi-docs.readthedocs.io/en/latest/Systemd.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("systemd"),e("OutboundLink")],1)])]),s._v(" "),e("h3",{attrs:{id:"建置-uwsgi-服務"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#建置-uwsgi-服務"}},[s._v("#")]),s._v(" 建置 uwsgi 服務")])])}),[],!1,null,null,null);e.default=t.exports}}]);