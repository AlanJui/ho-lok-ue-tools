(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{413:function(t,a,e){"use strict";e.r(a);var n=e(10),r=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"在-ubuntu-18-04-使用-vagrant-box-for-libvirt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-ubuntu-18-04-使用-vagrant-box-for-libvirt"}},[t._v("#")]),t._v(" 在 Ubuntu 18.04 使用 Vagrant Box for Libvirt")]),t._v(" "),a("p",[t._v("在 Ubuntu 作業系統，可使用 virt-manager 管理符合 Libvirt API 規格之「虛擬機器（VM：Virtual Machine）」。")]),t._v(" "),a("p",[t._v("VM 之建置作業，採用 Vagrant Box 建置 VM 可降低不少時間。但 Vagrant Box 預設之 VM 執行環境為：VirtualBox。 若不熟悉這些「眉角」，每當執行 "),a("strong",[t._v("vagrant up")]),t._v(" 指令後，總會在終端機看到 VM 無法正常啟動的錯誤訊息。")]),t._v(" "),a("p",[t._v("本文件用於指引：在 Ubuntu 18.04 作業系統，如何正確安裝 Vagrant Box for Libvirt ；及正常啟動 VM。")]),t._v(" "),a("h1",{attrs:{id:"安裝-vagrant-軟體套件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-vagrant-軟體套件"}},[t._v("#")]),t._v(" 安裝 Vagrant 軟體套件")]),t._v(" "),a("p",[t._v("以下為：Vagrant 2.2.6 安裝作業。")]),t._v(" "),a("p",[t._v("作業之程序步驟為：")]),t._v(" "),a("ul",[a("li",[t._v("先在 Client 端電腦（作業系統：macOS），透過 Web Brower 下載安裝檔案；")]),t._v(" "),a("li",[t._v("再於 Server 端電腦進行 Vagrant 安裝。")])]),t._v(" "),a("h2",{attrs:{id:"_1-在-macos-下載-vagrant-安裝檔案-deb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-在-macos-下載-vagrant-安裝檔案-deb"}},[t._v("#")]),t._v(" （1）在 macOS 下載 Vagrant 安裝檔案（.deb）")]),t._v(" "),a("p",[t._v("在 Mac 電腦，啟動 Web Browser 後，至 Vagrant 官網下載安裝檔案（.deb）。")]),t._v(" "),a("p",[t._v("https://www.vagrantup.com/downloads.html")]),t._v(" "),a("h2",{attrs:{id:"_2-在-ubuntu-18-04-複製安裝檔案-deb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-在-ubuntu-18-04-複製安裝檔案-deb"}},[t._v("#")]),t._v(" （2）在 Ubuntu 18.04 複製安裝檔案（.deb）")]),t._v(" "),a("p",[t._v("在 Client 端電腦啟動「終端機」，透過 ssh 登入伺服器。然後將先前已下載之 Vagrant 安裝檔案，複製到 Server 端的硬碟。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("$ ssh web_admin@192.168.66.10\n$ cd ~/_tmp\n$ scp alanjui@192.168.66.100:~/Downloads/vagrant_2.2.6_x86_64.deb .\n")])])]),a("h2",{attrs:{id:"_3-透過-dpkg-安裝-vagrant"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-透過-dpkg-安裝-vagrant"}},[t._v("#")]),t._v(" （3）透過 dpkg 安裝 Vagrant")]),t._v(" "),a("p",[t._v("使用 dpkg 執行檔案格式為 .deb 之安裝作業。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("$ sudo dpkg -i vagrant_2.2.6_x86_64.deb\n選取了原先未選的套件 vagrant。\n（讀取資料庫 ... 目前共安裝了 359404 個檔案和目錄。）\n準備解開 vagrant_2.2.6_x86_64.deb ...\n解開 vagrant (1:2.2.6) 中...\n設定 vagrant (1:2.2.6) ...\n")])])]),a("h2",{attrs:{id:"_4-驗證安裝結果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-驗證安裝結果"}},[t._v("#")]),t._v(" （4）驗證安裝結果")]),t._v(" "),a("p",[t._v("執行以下指令，確認 Vagrant 已完成安裝，且可正常運作。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("$ vagrant --version\nVagrant 2.2.6\n")])])]),a("h1",{attrs:{id:"安裝-vagrant-box-for-libvirt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安裝-vagrant-box-for-libvirt"}},[t._v("#")]),t._v(" 安裝 Vagrant Box for Libvirt")]),t._v(" "),a("p",[t._v("以下安裝之 Vagrant Box for Libvirt 為 Ubuntu 18.04.3 Desktop 版本。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("$ vagrant box add peru/ubuntu-18.04-desktop-amd64 --provider=libvirt\n\n$ mkdir -p ~/workspace/vagrant-libvirt/ubuntu-1804 && cd $_\n\n$ vagrant init peru/ubuntu-18.04-desktop-amd64 --box-version 20190901.01\n\n$ vagrant up\nBringing machine 'default' up with 'libvirt' provider...\n==> default: Checking if box 'peru/ubuntu-18.04-desktop-amd64' is up to date...\n==> default: Uploading base box image as volume into libvirt storage...\n==> default: Creating image (snapshot of base box volume).\n==> default: Creating domain with the following settings...\n==> default:  -- Name:              ubuntu-1804_default\n==> default:  -- Domain type:       kvm\n==> default:  -- Cpus:              1\n==> default:  -- Feature:           acpi\n==> default:  -- Feature:           apic\n==> default:  -- Feature:           pae\n==> default:  -- Memory:            2048M\n==> default:  -- Management MAC:\n==> default:  -- Loader:\n==> default:  -- Nvram:\n==> default:  -- Base box:          peru/ubuntu-18.04-desktop-amd64\n==> default:  -- Storage pool:      default\n==> default:  -- Image:             /var/lib/libvirt/images/ubuntu-1804_default.img (50G)\n==> default:  -- Volume Cache:      default\n==> default:  -- Kernel:\n==> default:  -- Initrd:\n==> default:  -- Graphics Type:     spice\n==> default:  -- Graphics Port:     -1\n==> default:  -- Graphics IP:       127.0.0.1\n==> default:  -- Base box:          peru/ubuntu-18.04-desktop-amd64\n==> default:  -- Storage pool:      default\n==> default:  -- Image:             /var/lib/libvirt/images/ubuntu-1804_default.img (50G)\n==> default:  -- Volume Cache:      default\n==> default:  -- Kernel:\n==> default:  -- Initrd:\n==> default:  -- Graphics Type:     spice\n==> default:  -- Graphics Port:     -1\n==> default:  -- Graphics IP:       127.0.0.1\n==> default:  -- Graphics Password: Not defined\n==> default:  -- Video Type:        qxl\n==> default:  -- Video VRAM:        9216\n==> default:  -- Sound Type:    ich6\n==> default:  -- Keymap:            en-us\n==> default:  -- TPM Path:\n==> default:  -- INPUT:             type=mouse, bus=ps2\n==> default:  -- CHANNEL:             type=unix, mode=\n==> default:  -- CHANNEL:             target_type=virtio, target_name=org.qemu.guest_agent.0\n==> default:  -- CHANNEL:             type=spicevmc, mode=\n==> default:  -- CHANNEL:             target_type=virtio, target_name=com.redhat.spice.0\n==> default:  -- RNG device model:  random\n==> default: Creating shared folders metadata...\n==> default: Starting domain.\n==> default: Waiting for domain to get an IP address...\n==> default: Waiting for SSH to become available...\n    default:\n    default: Vagrant insecure key detected. Vagrant will automatically replace\n    default: this with a newly generated keypair for better security.\n    default:\n    default: Inserting generated public key within guest...\n    default: Removing insecure key from the guest if it's present...\n    default: Key inserted! Disconnecting and reconnecting using new SSH key...\n==> default: Configuring and enabling network interfaces...\n\n$ vagrant status\nCurrent machine states:\n\ndefault                   running (libvirt)\n\nThe Libvirt domain is running. To stop this machine, you can run\n`vagrant halt`. To destroy the machine, you can run `vagrant destroy`. \n\n$ vagrant ssh\nWelcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-58-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\n\n0 packages can be updated.\n0 updates are security updates.\n")])])]),a("h1",{attrs:{id:"參考文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#參考文件"}},[t._v("#")]),t._v(" 參考文件")]),t._v(" "),a("p",[a("strong",[t._v("How to Install and Configure KVM on Ubuntu 18.04 LTS Server")]),t._v("\nhttps://www.linuxtechi.com/install-configure-kvm-ubuntu-18-04-server/")]),t._v(" "),a("p",[a("strong",[t._v("Vagrant and Libvirt with KVM or QEMU")]),t._v("\nhttps://docs.cumulusnetworks.com/cumulus-vx/Development-Environments/Vagrant-and-Libvirt-with-KVM-or-QEMU/")]),t._v(" "),a("p",[a("strong",[t._v("How to Use Vagrant with Libvirt on Linux")])]),t._v(" "),a("p",[t._v("https://computingforgeeks.com/using-vagrant-with-libvirt-on-linux/")]),t._v(" "),a("p",[t._v("https://www.youtube.com/watch?v=N7i14Icul_c&")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://youtu.be/N7i14Icul_c",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://youtu.be/N7i14Icul_c"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);