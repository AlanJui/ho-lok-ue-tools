(window.webpackJsonp=window.webpackJsonp||[]).push([[228],{511:function(t,_,s){"use strict";s.r(_);var n=s(10),e=Object(n.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"使用-timeshift-備份與恢復作業系統"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#使用-timeshift-備份與恢復作業系統"}},[t._v("#")]),t._v(" 使用 TimeShift 備份與恢復作業系統")]),t._v(" "),_("p",[t._v("https://blog.csdn.net/wf19930209/article/details/104236358")]),t._v(" "),_("h1",{attrs:{id:"timeshift系统备份与还原"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#timeshift系统备份与还原"}},[t._v("#")]),t._v(" "),_("strong",[t._v("Timeshift系统备份与还原")])]),t._v(" "),_("h2",{attrs:{id:"系统备份"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#系统备份"}},[t._v("#")]),t._v(" "),_("strong",[t._v("系统备份")])]),t._v(" "),_("p",[t._v("一般Linux系统是比较稳定的，但是一旦崩溃就很难恢复，这里介绍 "),_("strong",[t._v("Timeshift")]),t._v("系统备份工具。")]),t._v(" "),_("ol",[_("li",[_("p",[t._v("安装Timeshift")]),t._v(" "),_("ul",[_("li",[t._v("ubuntu 和 linux mint\nsudo apt-add-repository -y ppa:teejee2008/ppa\nsudo apt-get update\nsudo apt-get install timeshif\n- 1\n- 2\n- 3")]),t._v(" "),_("li",[t._v("deepin")]),t._v(" "),_("li",[t._v("deepin 安装相对比较复杂，但是在国外有一个 "),_("strong",[t._v("DEEPINES")]),t._v(" 补充库，主要针对deepin不支持的软件移植。")]),t._v(" "),_("li",[t._v("下载仓库安装包，访问此"),_("a",{attrs:{href:"https://xn--deepinenespaol-1nb.org/en/repository/",target:"_blank",rel:"noopener noreferrer"}},[t._v("网站下载"),_("OutboundLink")],1),t._v("，或者百度网盘"),_("code",[t._v("链接: https://pan.baidu.com/s/1sK0FiVaF_W_8YM94kpA8Uw 提取码: 98uk")]),t._v("。")]),t._v(" "),_("li",[t._v("安装扩展库包：\nsudo dpkg -i deepines-repository_3.1_amd64.deb\n- 1\nsudo apt-get update\nsudo apt-get install timeshift\n- 1\n- 2")])])]),t._v(" "),_("li",[_("p",[t._v("打开timeshift软件，设置备份与还原类型：\n"),_("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200209155523306.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmMTk5MzAyMDk=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),t._v(" "),_("li",[_("p",[t._v("此处选择【RSYNC】")])]),t._v(" "),_("li",[_("p",[t._v("在【位置】选项内选择快照存储的位置：\n"),_("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200209155604585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmMTk5MzAyMDk=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),t._v(" "),_("blockquote",[_("p",[t._v("每台设备安装分区不一样，大家安装实际情况选择，一般选择比较大的空间存储，并且最好是机械，这样不容易损坏。")])])]),t._v(" "),_("li",[_("p",[t._v("在【计划】选项内不定期做备份\n"),_("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200209155630669.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmMTk5MzAyMDk=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),t._v(" "),_("li",[_("p",[t._v("不选择周期备份的原因是因为磁盘占用空间会不断增长，需要定期清理。")])]),t._v(" "),_("li",[_("p",[t._v("在【用户】选项内设置需要备份的分区，"),_("strong",[t._v("root")]),t._v("默认就是全备份的，经测试更改也是无效的，也就是"),_("strong",[t._v("root")]),t._v("必须备份。\n"),_("img",{attrs:{src:"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9ub3RlLnlvdWRhby5jb20veXdzL3B1YmxpYy9yZXNvdXJjZS8zNzQ0ZjRjZDk2Yjk3MjBkNzcyYWY3OGNkY2I1NTljNC94bWxub3RlL1dFQlJFU09VUkNFZTQyOWM2ZTU3ZjM1Mjc5NWViYjI0YTU1YTk5OWM1OTgvNjU0NzI?x-oss-process=image/format,png",alt:"image"}})])]),t._v(" "),_("li",[_("p",[t._v("建议这样配置：")]),t._v(" "),_("ul",[_("li",[t._v("root选择【包含一切】或者【排除一切】")]),t._v(" "),_("li",[t._v("home选择【排除一切】")])])]),t._v(" "),_("li",[_("p",[t._v("在【筛选】选项内可以自定义备份文件或文件夹\n"),_("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200209155658744.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmMTk5MzAyMDk=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),t._v(" "),_("li",[_("p",[t._v("例如上图中就是"),_("code",[t._v("/home/vincent")]),t._v("目录下除了"),_("code",[t._v(".config")]),t._v("、"),_("code",[t._v(".cinnamon")]),t._v("、"),_("code",[t._v(".local")]),t._v("文件夹外都不备份。")])]),t._v(" "),_("li",[_("p",[t._v("建议这样配置：")]),t._v(" "),_("ul",[_("li",[t._v("先将home整个目录排除，添加"),_("code",[t._v("/home/vincent/**")])]),t._v(" "),_("li",[t._v("home目录下比较重要的如："),_("code",[t._v(".local")]),t._v("、"),_("code",[t._v(".config")]),t._v("等，需要加入，切记要加上"),_("code",[t._v("***")]),t._v("三个星")])])]),t._v(" "),_("li",[_("p",[t._v("创建快照")])]),t._v(" "),_("li",[_("p",[t._v("此时timeshift会根据时间生成一个带有时间戳的快照，此过程需要等待一段时间，并且期间不要对电脑执行任何操作。")])])]),t._v(" "),_("h2",{attrs:{id:"还原主要针对三种情况"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#还原主要针对三种情况"}},[t._v("#")]),t._v(" "),_("strong",[t._v("还原主要针对三种情况")])]),t._v(" "),_("p",[_("strong",[t._v("如果能够进入系统")])]),t._v(" "),_("ol",[_("li",[_("p",[t._v("如果此时还能够进入系统，直接打开 "),_("strong",[t._v("Timeshift")]),t._v("软件进行还原：\n"),_("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200209155735896.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmMTk5MzAyMDk=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),t._v(" "),_("li",[_("p",[t._v("在弹出的窗口内点击下一步开始进行还原到选中的节点：\n"),_("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200209155746216.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmMTk5MzAyMDk=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])])]),t._v(" "),_("p",[t._v("还原完成后重启电脑即可。\n"),_("strong",[t._v("如果只能进入登录界面")]),t._v("\n一般系统崩溃后不能进入桌面，但是能够进入登录界面，现象就是在登录界面输入密码后不会进入桌面，那么就要通过命令行的方式进行还原。")]),t._v(" "),_("ol",[_("li",[_("p",[t._v("通过"),_("code",[t._v("Ctrl+Alt+F1")]),t._v("（一般是F1-F6都可）进入tty终端：")])]),t._v(" "),_("li",[_("p",[t._v("输入用户和密码登录")])]),t._v(" "),_("li",[_("p",[t._v("执行下面命令获取系统当前可以还原的节点：\nsudo timeshift --list\n- 1")])]),t._v(" "),_("li",[_("p",[t._v("输出内容：\nDevice : /dev/sdb4\nUUID   : 197c4161-abc6-4069-8544-d86594211f04\nPath   : /home\nMode   : RSYNC\nDevice is OK\n12 snapshots, 92.5 GB free")]),t._v(" "),_("h2",{attrs:{id:"num-name-tags-description"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#num-name-tags-description"}},[t._v("#")]),t._v(" Num     Name                 Tags  Description")]),t._v(" "),_("p",[t._v("0    >  2018-08-08_11-49-26  O D"),_("br"),t._v("\n1    >  2018-08-13_23-02-06  O"),_("br"),t._v("\n2    >  2018-08-15_22-53-24  O"),_("br"),t._v("\n3    >  2018-08-21_09-37-29  O"),_("br"),t._v("\n4    >  2018-11-19_17-43-59  O"),_("br"),t._v("\n5    >  2019-01-20_19-36-34  O"),_("br"),t._v("\n6    >  2019-03-01_11-18-09  O"),_("br"),t._v("\n7    >  2019-03-01_14-54-37  O"),_("br"),t._v("\n8    >  2019-03-04_14-48-57  O"),_("br"),t._v("\n9    >  2019-03-10_20-50-00  O"),_("br"),t._v("\n10   >  2019-03-14_11-51-54  O"),_("br"),t._v("\n11   >  2019-07-16_16-35-42  O\n- 1\n- 2\n- 3\n- 4\n- 5\n- 6\n- 7\n- 8\n- 9\n- 10\n- 11\n- 12\n- 13\n- 14\n- 15\n- 16\n- 17\n- 18\n- 19\n- 20\n- 21")])]),t._v(" "),_("li",[_("p",[t._v("选择一个节点进行还原\nsudo timeshift --restore --snapshot '2019-07-16_16-35-42' --skip-grub\n- 1")]),t._v(" "),_("blockquote",[_("p",[t._v("–skip-grub 选项为跳过grub安装，一般来说grub不需要重新安装，除非bios启动无法找到正确的grub启动项，才需要安装。")])])]),t._v(" "),_("li",[_("p",[t._v("在输出的内容中依次输入【Enter】键和【y】键。")])]),t._v(" "),_("li",[_("p",[t._v("当然也可以直接输入下面的命令，忽略交互式的安装界面：\nsudo timeshift --restore --snapshot '2019-07-16_16-35-42' --skip-grub --scripted\n- 1")])])]),t._v(" "),_("p",[_("strong",[t._v("无法进入系统，通过U盘启动系统")]),t._v("\n当登录界面和桌面环境都无法进入时，一般系统已经彻底崩溃，此时只能通过Linux live CD进行还原。")]),t._v(" "),_("ol",[_("li",[_("p",[t._v("制作Linux Mint 启动盘，制作过程略。")])]),t._v(" "),_("li",[_("p",[t._v("进入Live系统后打开 "),_("strong",[t._v("Timeshift")]),t._v(" 软件，点击设置按钮，设置快照的存储位置：\n"),_("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200209155604585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmMTk5MzAyMDk=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),t._v(" "),_("blockquote",[_("p",[t._v("快照的存储位置是"),_("strong",[t._v("Timeshift")]),t._v("在做备份的时候就已经设置好的。")])])]),t._v(" "),_("li",[_("p",[t._v("后续步骤和【"),_("a",{attrs:{href:"https://blog.csdn.net/wf19930209/article/details/104236358#jump",target:"_blank",rel:"noopener noreferrer"}},[t._v("如果能够进入系统"),_("OutboundLink")],1),t._v("】内的还原方式一样。")])])]),t._v(" "),_("p",[t._v("其实此时还可以通过命令行的方式进行还原，但是首先需要设置快照存储的位置：")]),t._v(" "),_("div",{staticClass:"language- extra-class"},[_("pre",[_("code",[t._v("sudo timeshift --snapshot-device /dev/sdb4\n    - 1\n")])])]),_("p",[t._v("后续步骤和【"),_("a",{attrs:{href:"https://blog.csdn.net/wf19930209/article/details/104236358#jump2",target:"_blank",rel:"noopener noreferrer"}},[t._v("如果只能进入登录界面"),_("OutboundLink")],1),t._v("】内的还原方式一样。")])])}),[],!1,null,null,null);_.default=e.exports}}]);