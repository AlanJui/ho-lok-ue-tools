(window.webpackJsonp=window.webpackJsonp||[]).push([[211],{497:function(e,s,t){"use strict";t.r(s);var n=t(10),a=Object(n.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"vnc-server-安裝筆記"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vnc-server-安裝筆記"}},[e._v("#")]),e._v(" VNC Server 安裝筆記")]),e._v(" "),s("h1",{attrs:{id:"ubuntu-desktop-螢幕分享"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-desktop-螢幕分享"}},[e._v("#")]),e._v(" Ubuntu Desktop 螢幕分享")]),e._v(" "),s("p",[e._v("已驗證可在 16.04, 18.04 正常執行。")]),e._v(" "),s("p",[s("strong",[e._v("（1）先在 Ubuntu Desktop 電腦，透過，完成「螢幕分享」的設定工作。")])]),e._v(" "),s("p",[s("img",{attrs:{src:"https://d2mxuefqeaa7sj.cloudfront.net/s_658302B4FACACF076DDCB0704829364CC3EE5F7037E5F4737FCB9B1DBABBDAE1_1524743791656_image.png",alt:""}})]),e._v(" "),s("p",[s("strong",[e._v("（2）打開「終端機」，輸入以下指令，要求 vnc server 對於畫面資料，無需進行加密處理。")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("$ gsettings set org.gnome.Vino require-encryption false\n")])])]),s("p",[s("strong",[e._v("（3）在另一台電腦，執行 vnc client軟體，如：realvnc viewer")])]),e._v(" "),s("hr"),e._v(" "),s("h1",{attrs:{id:"使用-vnc-server-vnc4server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-vnc-server-vnc4server"}},[e._v("#")]),e._v(" 使用 VNC Server: vnc4server")]),e._v(" "),s("p",[e._v("已驗證可在 DeepIn 運作。")]),e._v(" "),s("h2",{attrs:{id:"安裝及設定作業"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安裝及設定作業"}},[e._v("#")]),e._v(" 安裝及設定作業")]),e._v(" "),s("p",[s("strong",[e._v("（1）安裝 VNC Server")]),e._v("\n在 Server 安裝 VNC Server 軟體。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("sudo apt-get update\nsudo apt install vnc4server\n")])])]),s("p",[s("strong",[e._v("（2）在系統新增 vnc 使用者帳號")])]),e._v(" "),s("p",[e._v("新增使用者帳號：vnc。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("$ sudo adduser vnc\n")])])]),s("p",[e._v("將使用者帳號 vnc ，加入 sudo 群組。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("$ sudo gpasswd -a vnc sudo\n")])])]),s("p",[s("strong",[e._v("（3）啟動 vnc server")])]),e._v(" "),s("p",[e._v("切換使用者，改為：vnc")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("sudo su - vnc\n")])])]),s("p",[e._v("啟動 vnc server")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("vncserver -localhost no\n")])])]),s("p",[e._v("【註】：上述的 vncserver 指令，若是首次執行，會被要求輸入 vnc client 連線時的「密碼」。密碼長度需為： 6 - 8 個字元。")]),e._v(" "),s("p",[e._v("若欲終止 vnc server 的執行，請用以下指令：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("vncserver -kill :1\n")])])]),s("p",[s("strong",[e._v("（4）使用 vnc client 連線 vnc server")])]),e._v(" "),s("p",[e._v("Safarill")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("vnc://192.168.66.72:5901\n")])])]),s("h2",{attrs:{id:"step-4-creating-a-vnc-service-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-4-creating-a-vnc-service-file"}},[e._v("#")]),e._v(" Step 4 — Creating a VNC Service File")]),e._v(" "),s("p",[e._v("Next, we'll set up the VNC server as a systemd service. This will make it possible to start, stop, and restart it as needed, like any other systemd service.")]),e._v(" "),s("p",[e._v("First, create a new unit file called "),s("code",[e._v("/etc/systemd/system/vncserver@.service")]),e._v(" using your favorite text editor:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("sudo nano /etc/systemd/system/vncserver@.service\n")])])]),s("p",[e._v("Copy and paste the following into it. Be sure to change the value of "),s("strong",[e._v("User")]),e._v(" and the username in the value of "),s("strong",[e._v("PIDFILE")]),e._v(" to match your username.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("[Unit]\nDescription=Start TightVNC server at startup\nAfter=syslog.target network.target\n\n[Service]\nType=forking\nUser=vnc\nPAMName=login\nPIDFile=/home/vnc/.vnc/%H:%i.pid\nExecStartPre=-/usr/bin/vncserver -kill :%i > /dev/null 2>&1\nExecStart=/usr/bin/vncserver -depth 24 -geometry 1280x800 :%i\nExecStop=/usr/bin/vncserver -kill :%i\n\n[Install]\nWantedBy=multi-user.target\n")])])]),s("p",[e._v("Save and close the file.\nNext, make the system aware of the new unit file.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("sudo systemctl daemon-reload\n")])])]),s("p",[e._v("Enable the unit file.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("sudo systemctl enable vncserver@1.service\n")])])]),s("p",[e._v("The "),s("code",[e._v("1")]),e._v(" following the "),s("code",[e._v("@")]),e._v(" sign signifies which display number the service should appear over, in this case the default "),s("code",[e._v(":1")]),e._v(" as was discussed above.\nStop the current instance of the VNC server if it's still running.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("vncserver -kill :1\n")])])]),s("p",[e._v("Then start it as you would start any other systemd service.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("sudo systemctl start vncserver@1\n")])])]),s("p",[e._v("You can verify that it started with this command:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("sudo systemctl status vncserver@1\n")])])]),s("p",[e._v("If it started correctly, the output should look like this:\nOutput")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("vncserver@1.service - TightVNC server on Ubuntu 16.04\n   Loaded: loaded (/etc/systemd/system/vncserver@.service; enabled; vendor preset: enabled)\n   Active: active (running) since Mon 2016-04-25 03:21:34 EDT; 6s ago\n  Process: 2924 ExecStop=/usr/bin/vncserver -kill :%i (code=exited, status=0/SUCCESS)\n\n...\n\n systemd[1]: Starting TightVNC server on Ubuntu 16.04...\n systemd[2938]: pam_unix(login:session): session opened for user finid by (uid=0)\n systemd[2949]: pam_unix(login:session): session opened for user finid by (uid=0)\n systemd[1]: Started TightVNC server on Ubuntu 16.04.\n")])])]),s("hr"),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("$ apt-get install gnome-panel gnome-settings-daemon metacity nautilus gnome-terminal\n")])])]),s("p",[e._v("/etc/vnc/xstartup")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("#!/bin/sh\n\nexport XKL_XMODMAP_DISABLE=1\nunset SESSION_MANAGER\nunset DBUS_SESSION_BUS_ADDRESS\n\n[ -x /etc/vnc/xstartup ] && exec /etc/vnc/xstartup\n[ -r $HOME/.Xresources ] && xrdb $HOME/.Xresources\nxsetroot -solid grey\nvncconfig -iconic &\n\ngnome-panel &\ngnome-settings-daemon &\nmetacity &\nnautilus &\ngnome-terminal &\n")])])])])}),[],!1,null,null,null);s.default=a.exports}}]);