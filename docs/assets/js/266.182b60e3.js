(window.webpackJsonp=window.webpackJsonp||[]).push([[266],{556:function(s,a,t){"use strict";t.r(a);var n=t(10),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"æ‡‰ç”¨ç³»çµ±ä½ˆç½²ä½œæ¥­æŒ‡å¼•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‡‰ç”¨ç³»çµ±ä½ˆç½²ä½œæ¥­æŒ‡å¼•"}},[s._v("#")]),s._v(" æ‡‰ç”¨ç³»çµ±ä½ˆç½²ä½œæ¥­æŒ‡å¼•")]),s._v(" "),a("h2",{attrs:{id:"æ‘˜è¦"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‘˜è¦"}},[s._v("#")]),s._v(" æ‘˜è¦")]),s._v(" "),a("p",[s._v("å¦‚ä½•åœ¨å·²å»ºç½®ä¹‹æ‡‰ç”¨ç³»çµ±å¹³å°ï¼Œã€Œä½ˆç½²ã€Django æ‡‰ç”¨ç³»çµ±ã€‚")]),s._v(" "),a("h2",{attrs:{id:"å‰æ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‰æ"}},[s._v("#")]),s._v(" å‰æ")]),s._v(" "),a("ul",[a("li",[s._v("pyenv å·²å®‰è£ä¸¦è¨­å®š")]),s._v(" "),a("li",[s._v("poetry å·²å®‰è£ä¸¦è¨­å®š")]),s._v(" "),a("li",[s._v("nginx å·²å®‰è£ä¸¦è¨­å®š")])]),s._v(" "),a("h2",{attrs:{id:"è‡ª-git-repo-ä¸‹è¼‰"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è‡ª-git-repo-ä¸‹è¼‰"}},[s._v("#")]),s._v(" è‡ª Git Repo ä¸‹è¼‰")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("é€²å…¥å°ˆæ¡ˆç›®éŒ„")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /apps\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("ä¸‹è¼‰ Repo")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone URL app3.ccc.tw.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("ç¢ºèªå·²æŒ‡å®š Python ç›´è­¯å™¨ç‰ˆæœ¬ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" app3.ccc.tw.local\npyenv version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("å»ºç«‹æ‡‰ç”¨ç³»çµ±ä½¿ç”¨ä¹‹ VirtualEnv ç’°å¢ƒã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("python "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" venv .venv\npoetry shell\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("å®‰è£æ‡‰ç”¨ç³»çµ±æ‰€éœ€ Python å¥—ä»¶ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("poetry "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("é©—è­‰ Django Web Server å·²èƒ½é‹ä½œã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("python manage.py collectstatic "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--noinput")]),s._v("\npython manage.py runserver\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"å»ºç½®-host-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å»ºç½®-host-name"}},[s._v("#")]),s._v(" å»ºç½® Host Name")]),s._v(" "),a("p",[s._v("åœ¨ Host æ¸…å–®ï¼ˆæª”æ¡ˆï¼š/etc/hostsï¼‰ï¼Œå»ºç½® Django æ‡‰ç”¨ç³»çµ±ä¹‹\nHost Name åŠä½¿ ç”¨ä¹‹ IP ã€‚")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("ç·¨è¼¯ Host æ¸…å–®ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("sudoedit /etc/hosts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("æ·»åŠ ä¸€ç­† Host èˆ‡ IP å°æ˜ ç´€éŒ„ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1       localhost\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1       SRV-2020\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".66.10   app.ccc.tw.local\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".66.10   app3.ccc.tw.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"å»ºç½®-http-è™›æ“¬ç¶²ç«™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å»ºç½®-http-è™›æ“¬ç¶²ç«™"}},[s._v("#")]),s._v(" å»ºç½® HTTP è™›æ“¬ç¶²ç«™")]),s._v(" "),a("p",[s._v("nginx çš„ã€Œè™›æ“¬ç¶²ç«™ã€åŠŸèƒ½ï¼Œå¯ä»¤ä¸€å° HTTP ä¼ºæœå™¨ï¼Œå»ºç½®åŠåŸ·è¡Œå¤š\nå€‹ç¶²ç«™ã€‚ æ¯å€‹ Django æ‡‰ç”¨ç³»çµ±ï¼Œå‡æœƒæœ‰ï¼š .css æ¨£å¼æª”ã€ .html\nç¶²é æ¨¡ç‰ˆæª”ã€.png/.jpg åœ–æª”... ç­‰éœæ…‹æª”æ¡ˆï¼Œè€ƒæ…®åˆ°æ‡‰ç”¨ç³»çµ±ä¹‹åŸ·\nè¡Œæ•ˆèƒ½ï¼Œç•¶ Web Client å‚³ä¾†ä¹‹ HTTP Request ï¼Œè‹¥è™•ç†çš„çµæœåªéœ€\nå›é€ã€Œéœæ…‹æª”æ¡ˆã€ï¼Œä¾› Web Client ä¸‹è¼‰ï¼Œå‰‡æ­¤ä½œæ¥­ ä¹‹åŸ·è¡Œç”±å°ˆè·\nçš„ HTTP æœå‹™ä¾†åŸ·è¡Œï¼Œæœƒæœ‰è¼ƒä½³ä¹‹æ•ˆèƒ½è¡¨ç¾ï¼Œæ•…è€Œäº¤ç”± nginx æ“”ç¶±\nè² è²¬ã€‚")]),s._v(" "),a("p",[s._v("ä»¥ä¸‹ä¹‹æ“ä½œï¼Œå°‡èªªæ˜ï¼šç•¶ nginx æœå‹™å·²æ–¼ä¼ºæœå™¨å®Œæˆå®‰è£å¾Œï¼Œè©²å¦‚\nä½•ä½œæ¥­ï¼Œå®Œæˆ Django æ‡‰ç”¨ç³»çµ±ä¹‹ HTTP ç¶²ç«™ã€‚")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("å¥—ç”¨ç¾æˆè™›æ“¬ç¶²ç«™è¨­å®šæª”ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/nginx/sites-available\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" app1.ccc.tw.local app3.ccc.tw.local\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("  app3.ccc.tw.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("ğŸ”– app3.ccc.tw.local:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v(" upstream django "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# server 127.0.0.1:8001;")]),s._v("\n     server unix:///apps/app3.ccc.tw.local/web_app.sock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     listen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n     server_name             app3.ccc.tw.local"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     charset                 utf-8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# max upload size")]),s._v("\n     client_max_body_size    75M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Django media")]),s._v("\n     location /media "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v("        /apps/app3.ccc.tw.local/media"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n     location /static "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v("        /apps/app3.ccc.tw.local/static_collected"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n     location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         uwsgi_pass   django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n         include      /apps/app3.ccc.tw.local/uwsgi_params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n     access_log      /var/log/nginx/app3-ccc-tw-local.log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     error_log       /var/log/nginx/app3-ccc-tw-local-error.log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("å•Ÿç”¨ HTTP è™›æ“¬ç¶²ç«™")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-nfs")]),s._v(" /etc/nginx/sites-available/app3.ccc.tw.local /etc/nginx/sites-enabled\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("ç¢ºèª Nginx è¨­å®šç„¡èª¤ã€‚")]),s._v(" "),a("p",[s._v("æª¢é©—ç¶²ç«™è¨­å®šèªæ³•æ­£ç¢ºç„¡èª¤ï¼Œç¢ºä¿ Nginx Service ä¸æœƒå› è¨­å®šéŒ¯\nèª¤ï¼Œå°è‡´æœå‹™ç„¡æ³•æ­£å¸¸å•Ÿå‹•ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("nginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("é‡å•Ÿ nginx æœå‹™ï¼Œä»¥ä¾¿æ–°é€²å»ºç½®ä¹‹ Django æ‡‰ç”¨ç³»çµ±ç¶²ç«™ï¼Œå·²èƒ½\næ­£å¸¸é‹ä½œã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx restart\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx status\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("æˆ–")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("systemctl restart nginx\nsystemclt status nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("é©—è­‰æ‡‰ç”¨ç³»çµ± HTTP è™šæ“¬ç¶²ç«™å·²èƒ½ç‚º static æª”æ¡ˆæä¾›ä¸‹è¼‰æœå‹™\nã€‚")]),s._v(" "),a("p",[s._v("ä½¿ç”¨ç€è¦½å™¨ï¼Œç€è¦½ç¶²å€ï¼š\n"),a("a",{attrs:{href:"http://app3.ccc.tw.local/static/css/site.css",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://app3.ccc.tw.local/static/css/site.css"),a("OutboundLink")],1),s._v(" ã€‚")]),s._v(" "),a("p",[s._v("è‹¥èƒ½æ–¼ç€è¦½å™¨çœ‹åˆ° site.css çš„å…§å®¹ï¼Œå³è¡¨ç¤º HTTP è™šæ“¬ç¶²ç«™å·²\nèƒ½æ­£å¸¸é‹ä½œï¼ŒåŒæ™‚å¯å° static å‹æ…‹çš„æª”æ¡ˆæä¾›ä¸‹è¼‰æœå‹™ã€‚")])])]),s._v(" "),a("h2",{attrs:{id:"å»ºç½®-uwsgi-è¨­å®šæª”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å»ºç½®-uwsgi-è¨­å®šæª”"}},[s._v("#")]),s._v(" å»ºç½® uWSGI è¨­å®šæª”")]),s._v(" "),a("p",[s._v("WSGI æœ¬èº«å°±æ˜¯ä¸€å€‹ä»‹é¢ï¼Œç”¨æ–¼å°‡ HTTP Server ç„¡æ³•è™•ç† HTTP\nRequest æ”¶ä¸‹ï¼›è½‰äºˆ Django Application è™•ç†ã€‚")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("web client "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" web server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" unix socket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" uWSGI "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Python\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uwsgi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("å»ºç«‹ uWSGI è¨­å®šæª”ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /apps/app3.ccc.tw.local\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" web_app_uwsgi.ini\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("ğŸ”– web_app_uwsgi.ini:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("uwsgi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Django-related settings")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the base directory (full path)")]),s._v("\nchdir           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /apps/app3.ccc.tw.local\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Django's wsgi file")]),s._v("\nmodule          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" app3.ccc.tw.local.web_app.wsgi\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the virtualenv (full path)")]),s._v("\nhome            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /apps/app3.ccc.tw.local/.venv\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# process-related settings")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# master")]),s._v("\nmaster          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# maximum number of worker processes")]),s._v("\nprocesses       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the socket (use the full path to be safe")]),s._v("\nsocket          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /apps/app3.ccc.tw.local/web_app.sock\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ... with appropriate permissions - may be needed")]),s._v("\nchmod-socket    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# clear environment on exit")]),s._v("\nvacuum          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("å®‰è£ uwsgi å¥—ä»¶ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("poetry "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" uwsgi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("é©—è­‰ Nginx <--\x3e uWSGI <--\x3e Django App é€šè¨Šå·²æ‰“é€šã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v(".venv/bin/uwsgi "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--ini")]),s._v(" web_app_uwsgi.ini\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("è‹¥ç„¡éŒ¯èª¤è¨Šæ¯ï¼Œå³è¡¨ç¤º Nginx <--\x3e uWSGI <--\x3e Django App é€š\nè¨Šå·²æ‰“é€šã€‚")])])]),s._v(" "),a("h2",{attrs:{id:"å»ºç½®è‡ªå‹•é–‹æ©Ÿæœå‹™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å»ºç½®è‡ªå‹•é–‹æ©Ÿæœå‹™"}},[s._v("#")]),s._v(" å»ºç½®è‡ªå‹•é–‹æ©Ÿæœå‹™")]),s._v(" "),a("p",[s._v("ç‚ºä½¿å·²ä½ˆç½²ä¹‹ Django æ‡‰ç”¨ç³»çµ±ï¼Œèƒ½æ–¼é–‹æ©Ÿå¾Œè‡ªå‹•å•Ÿå‹•ã€‚æ•…éœ€å»ºç½®åŠ\nå•Ÿç”¨ Django æ‡‰ç”¨ç³»çµ±å°ˆç”¨ä¹‹æœå‹™ã€‚")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("å»ºç½® app3 æœå‹™è¨­å®šæª”ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("sudoedit /etc/systemd/system/app3.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("ã€æª”æ¡ˆå…§å®¹ã€‘ï¼š")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Unit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("uWSGI instance to serve app3.ccc.tw.local\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStartPre")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-/usr/bin/bash "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mkdir -p /run/uwsgi; chown www-data:www-data /run/uwsgi'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/bash "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cd /apps/app3-ccc-tw-local; \\\n/apps/app3-ccc-tw-local/.venv/bin/uwsgi --ini web_app_uwsgi.ini'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("multi-user.target\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("å•Ÿç”¨ app3 æœå‹™ã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" app3\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start app3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("æª¢è¦– app3 æœå‹™ï¼Œç¢ºèªè©²æœå‹™å·²èƒ½æ­£å¸¸é‹ä½œã€‚")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl status app3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);